
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>File_level_Category_3</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="Author" content="Anonymous">
    <meta name="Keywords" content="file,category">
    <meta name="Description" content="">
    <link href="Assets/layui-v2.4.5/layui/css/layui.css" rel="stylesheet" />
    <script type="text/javascript" src="Scripts/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="Assets/layui-v2.4.5/layui/layui.js"></script>
    <style type="text/css">
        .component {
            width: 160px;
        }

        .searchbox {
            float: right;
            margin-top: 16px;
        }

            .searchbox ul li {
                display: inline-block;
            }

            .searchbox .searchinput {
                height: 30px;
            }
    </style>
    <script type="text/javascript">
        var __PageSize = 10;
    </script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?98ca367613cc2e6cb07af6941d206613";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <script>
        (function () {
            var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
            document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>
    <script>
        (function () {
            var el = document.createElement("script");
            el.src = "https://sf1-scmcdn-tos.pstatp.com/goofy/ttzz/push.js?22b548e786319b719ef88faf7d4a36dd0067dc1f7950828ecde1aa80e83255942c45b12be7ebe6ff56e915264ffe82297d4bbc6eb70d055f539142cd2fb93fe8";
            el.id = "ttzz";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(el, s);
        })(window)
    </script>
</head>
<body class="layui-bg-gray">
    <div class="layui-fluid  layui-bg-green">
        <div class="">
            <ul class="layui-container layui-nav layui-bg-green">
                <li class="layui-nav-item "><a href="index.html">Home</a></li>
                <li class="layui-nav-item ">
                    <a href="/1projects.html">Projects</a>
                </li>
                <li class="layui-nav-item ">
                    <a href="#">Method Level</a>
                    <dl class="layui-nav-child">
                        <dd><a href="/2method_a.html">All</a></dd>
                        <dd><a href="/2method_c_1.html ">Category:Config</a></dd>
                        <dd><a href="/2method_c_2.html">Category:Function</a></dd>
                        <dd><a href="/2method_c_3.html ">Category:Fixed Format</a></dd>
                        <dd><a href="/2method_c_4.html">Category:Other</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a href="#">File Level</a>
                    <dl class="layui-nav-child">
                        <dd><a href="/3file_a.html">All</a></dd>
                        <dd><a href="/3file_c_1.html">Category:DPFile</a></dd>
                        <dd><a href="/3file_c_2.html">Category:DRFile</a></dd>
                        <dd><a href="/3file_c_3.html">Category:DIFile</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item ">
                    <a href="/4download.html">Data Download</a>
                </li>
            </ul>
        </div>
    </div>
    <br />

<style type="text/css">
    .btncus {
    }
</style>
<div class="layui-container">
    <div class="layui-row layui-col-space20">
        <div class="layui-col-xs12">
            <div class="layui-tab layui-tab-card">
                <ul class="layui-tab-title">
                    <li class="layui-this">CFile(Config File)</li>
                    <li>EHFile(Exception Handling File)</li>
                    <li>UFile(Utility File)</li>
                    <li>CSFile(Communication Support File)</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <div class="layui-card" id="1" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.207</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>api-gateway\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="2" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.208</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>eureka-server\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="3" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.209</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>order-service\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="4" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.211</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>product-catalog-service\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="5" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.213</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>product-recommendation-service\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="6" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.215</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> MavenWrapperDownloader.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>user-service\.mvn\wrapper\MavenWrapperDownloader.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
/*
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import java.util.Properties;

public class MavenWrapperDownloader {

    /**
     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
     */
    private static final String DEFAULT_DOWNLOAD_URL =
            "https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar";

    /**
     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
     * use instead of the default one.
     */
    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
            ".mvn/wrapper/maven-wrapper.properties";

    /**
     * Path where the maven-wrapper.jar will be saved to.
     */
    private static final String MAVEN_WRAPPER_JAR_PATH =
            ".mvn/wrapper/maven-wrapper.jar";

    /**
     * Name of the property which should be used to override the default download url for the wrapper.
     */
    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";

    public static void main(String args[]) {
        System.out.println("- Downloader started");
        File baseDirectory = new File(args[0]);
        System.out.println("- Using base directory: " + baseDirectory.getAbsolutePath());

        // If the maven-wrapper.properties exists, read it and check if it contains a custom
        // wrapperUrl parameter.
        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
        String url = DEFAULT_DOWNLOAD_URL;
        if (mavenWrapperPropertyFile.exists()) {
            FileInputStream mavenWrapperPropertyFileInputStream = null;
            try {
                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
                Properties mavenWrapperProperties = new Properties();
                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
            } catch (IOException e) {
                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
            } finally {
                try {
                    if (mavenWrapperPropertyFileInputStream != null) {
                        mavenWrapperPropertyFileInputStream.close();
                    }
                } catch (IOException e) {
                    // Ignore ...
                }
            }
        }
        System.out.println("- Downloading from: : " + url);

        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
        if (!outputFile.getParentFile().exists()) {
            if (!outputFile.getParentFile().mkdirs()) {
                System.out.println(
                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
            }
        }
        System.out.println("- Downloading to: " + outputFile.getAbsolutePath());
        try {
            downloadFileFromURL(url, outputFile);
            System.out.println("Done");
            System.exit(0);
        } catch (Throwable e) {
            System.out.println("- Error downloading");
            e.printStackTrace();
            System.exit(1);
        }
    }

    private static void downloadFileFromURL(String urlString, File destination) throws Exception {
        URL website = new URL(urlString);
        ReadableByteChannel rbc;
        rbc = Channels.newChannel(website.openStream());
        FileOutputStream fos = new FileOutputStream(destination);
        fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
        fos.close();
        rbc.close();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="7" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.220</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> CacheConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-outside\src\main\java\com\stalary\pf\outside\config\CacheConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.outside.config;

import com.alibaba.fastjson.support.spring.GenericFastJsonRedisSerializer;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.CacheErrorHandler;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * CacheConfig
 *
 * @author lirongqian
 * @since 2018/10/22
 */
@Configuration
@Slf4j
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * redis序列化配置，使用lettuce客户端
     */
    @Bean
    public &lt;T&gt; RedisTemplate&lt;String, T&gt; redisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, T&gt; template = new RedisTemplate&lt;&gt;();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new GenericFastJsonRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        StringRedisTemplate template = new StringRedisTemplate();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new StringRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new StringRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {
            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                log.warn("获取缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                log.warn("handleCachePutError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                log.warn("handleCacheEvictError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("清除缓存时异常--- 异常信息:" + e);
            }
        };
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="8" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.221</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> PrefixRedisSerializer.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-outside\src\main\java\com\stalary\pf\outside\config\PrefixRedisSerializer.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.outside.config;

import com.stalary.pf.outside.data.Constant;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.stereotype.Component;
import org.springframework.util.Assert;

import java.nio.charset.Charset;

/**
 * PrefixRedisSerializer
 *
 * @author lirongqian
 * @since 2018/10/21
 */
@Component
@Slf4j
public class PrefixRedisSerializer implements RedisSerializer&lt;String&gt; {

    private String prefix = "pf";

    private final Charset charset;

    public PrefixRedisSerializer() {
        this(Charset.forName("UTF8"));
    }

    public PrefixRedisSerializer(Charset charset) {
        Assert.notNull(charset, "Charset must not be null!");
        this.charset = charset;
    }


    @Override
    public String deserialize(byte[] bytes) {
        String saveKey = new String(bytes, charset);
        int indexOf = saveKey.indexOf(prefix);
        if (indexOf &gt; 0) {
            log.warn("key缺少前缀");
        } else {
            saveKey = saveKey.substring(indexOf + prefix.length() + 1);
        }
        return saveKey;
    }

    @Override
    public byte[] serialize(String string) {
        String key = prefix + Constant.SPLIT + string;
        return key.getBytes(charset);
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="9" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.223</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> CacheConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-push\src\main\java\com\stalary\pf\push\config\CacheConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.push.config;

import com.alibaba.fastjson.support.spring.GenericFastJsonRedisSerializer;
import com.stalary.pf.push.service.MessageService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.CacheErrorHandler;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.listener.PatternTopic;
import org.springframework.data.redis.listener.RedisMessageListenerContainer;
import org.springframework.data.redis.listener.adapter.MessageListenerAdapter;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * CacheConfig
 *
 * @author lirongqian
 * @since 2018/10/22
 */
@Configuration
@Slf4j
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * redis序列化配置，使用lettuce客户端
     */
    @Bean
    public &lt;T&gt; RedisTemplate&lt;String, T&gt; redisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, T&gt; template = new RedisTemplate&lt;&gt;();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new GenericFastJsonRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        StringRedisTemplate template = new StringRedisTemplate();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new StringRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new StringRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {
            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                log.warn("获取缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                log.warn("handleCachePutError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                log.warn("handleCacheEvictError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("清除缓存时异常--- 异常信息:" + e);
            }
        };
    }

    @Bean
    RedisMessageListenerContainer container(RedisConnectionFactory connectionFactory,
                                            MessageListenerAdapter listenerAdapter) {
        RedisMessageListenerContainer container = new RedisMessageListenerContainer();
        container.setConnectionFactory(connectionFactory);
        // 订阅频道
        container.addMessageListener(listenerAdapter, new PatternTopic(MessageService.MESSAGE_CHANNEL));
        container.addMessageListener(listenerAdapter, new PatternTopic(MessageService.CLOSE_CHANNEL));
        return container;
    }

    @Bean
    MessageListenerAdapter listenerAdapter(MessageService receiver) {
        return new MessageListenerAdapter(receiver, "receiveMessage");
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="10" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.224</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> PrefixRedisSerializer.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-push\src\main\java\com\stalary\pf\push\config\PrefixRedisSerializer.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.push.config;

import lombok.extern.slf4j.Slf4j;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.stereotype.Component;
import org.springframework.util.Assert;

import java.nio.charset.Charset;

/**
 * PrefixRedisSerializer
 *
 * @author lirongqian
 * @since 2018/10/21
 */
@Component
@Slf4j
public class PrefixRedisSerializer implements RedisSerializer&lt;String&gt; {

    private String prefix = "pf";

    private final Charset charset;

    public PrefixRedisSerializer() {
        this(Charset.forName("UTF8"));
    }

    public PrefixRedisSerializer(Charset charset) {
        Assert.notNull(charset, "Charset must not be null!");
        this.charset = charset;
    }


    @Override
    public String deserialize(byte[] bytes) {
        String saveKey = new String(bytes, charset);
        int indexOf = saveKey.indexOf(prefix);
        if (indexOf &gt; 0) {
            log.warn("key缺少前缀");
        } else {
            saveKey = saveKey.substring(indexOf + prefix.length() + 1);
        }
        return saveKey;
    }

    @Override
    public byte[] serialize(String string) {
        String key = prefix + ":" + string;
        return key.getBytes(charset);
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="11" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.225</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> CacheConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-recruit\src\main\java\com\stalary\pf\recruit\config\CacheConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.recruit.config;

import com.alibaba.fastjson.support.spring.GenericFastJsonRedisSerializer;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.CacheErrorHandler;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * CacheConfig
 *
 * @author lirongqian
 * @since 2018/10/22
 */
@Configuration
@Slf4j
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * redis序列化配置，使用lettuce客户端
     */
    @Bean
    public &lt;T&gt; RedisTemplate&lt;String, T&gt; redisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, T&gt; template = new RedisTemplate&lt;&gt;();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new GenericFastJsonRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        StringRedisTemplate template = new StringRedisTemplate();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new StringRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new StringRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {
            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                log.warn("获取缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                log.warn("handleCachePutError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                log.warn("handleCacheEvictError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("清除缓存时异常--- 异常信息:" + e);
            }
        };
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="12" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.226</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> PrefixRedisSerializer.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-recruit\src\main\java\com\stalary\pf\recruit\config\PrefixRedisSerializer.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.recruit.config;

import com.stalary.pf.recruit.data.constant.Constant;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.stereotype.Component;
import org.springframework.util.Assert;

import java.nio.charset.Charset;

/**
 * PrefixRedisSerializer
 *
 * @author lirongqian
 * @since 2018/10/21
 */
@Component
@Slf4j
public class PrefixRedisSerializer implements RedisSerializer&lt;String&gt; {

    private String prefix = "pf";

    private final Charset charset;

    public PrefixRedisSerializer() {
        this(Charset.forName("UTF8"));
    }

    public PrefixRedisSerializer(Charset charset) {
        Assert.notNull(charset, "Charset must not be null!");
        this.charset = charset;
    }


    @Override
    public String deserialize(byte[] bytes) {
        String saveKey = new String(bytes, charset);
        int indexOf = saveKey.indexOf(prefix);
        if (indexOf &gt; 0) {
            log.warn("key缺少前缀");
        } else {
            saveKey = saveKey.substring(indexOf + prefix.length() + 1);
        }
        return saveKey;
    }

    @Override
    public byte[] serialize(String string) {
        String key = prefix + Constant.SPLIT + string;
        return key.getBytes(charset);
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="13" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.228</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> CacheConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-resume\src\main\java\com\stalary\pf\resume\config\CacheConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.resume.config;

import com.alibaba.fastjson.support.spring.GenericFastJsonRedisSerializer;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.CacheErrorHandler;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * CacheConfig
 *
 * @author lirongqian
 * @since 2018/10/22
 */
@Configuration
@Slf4j
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * redis序列化配置，使用lettuce客户端
     */
    @Bean
    public &lt;T&gt; RedisTemplate&lt;String, T&gt; redisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, T&gt; template = new RedisTemplate&lt;&gt;();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new GenericFastJsonRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        StringRedisTemplate template = new StringRedisTemplate();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new StringRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new StringRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {
            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                log.warn("获取缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                log.warn("handleCachePutError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                log.warn("handleCacheEvictError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("清除缓存时异常--- 异常信息:" + e);
            }
        };
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="14" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.229</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> PrefixRedisSerializer.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-resume\src\main\java\com\stalary\pf\resume\config\PrefixRedisSerializer.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.resume.config;

import com.stalary.pf.resume.data.constant.Constant;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.stereotype.Component;
import org.springframework.util.Assert;

import java.nio.charset.Charset;

/**
 * PrefixRedisSerializer
 *
 * @author lirongqian
 * @since 2018/10/21
 */
@Component
@Slf4j
public class PrefixRedisSerializer implements RedisSerializer&lt;String&gt; {

    private String prefix = "pf";

    private final Charset charset;

    public PrefixRedisSerializer() {
        this(Charset.forName("UTF8"));
    }

    public PrefixRedisSerializer(Charset charset) {
        Assert.notNull(charset, "Charset must not be null!");
        this.charset = charset;
    }


    @Override
    public String deserialize(byte[] bytes) {
        String saveKey = new String(bytes, charset);
        int indexOf = saveKey.indexOf(prefix);
        if (indexOf &gt; 0) {
            log.warn("key缺少前缀");
        } else {
            saveKey = saveKey.substring(indexOf + prefix.length() + 1);
        }
        return saveKey;
    }

    @Override
    public byte[] serialize(String string) {
        String key = prefix + Constant.SPLIT + string;
        return key.getBytes(charset);
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="15" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.231</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> CacheConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-user\src\main\java\com\stalary\pf\user\config\CacheConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.user.config;

import com.alibaba.fastjson.support.spring.GenericFastJsonRedisSerializer;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.Cache;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.interceptor.CacheErrorHandler;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.StringRedisSerializer;

/**
 * CacheConfig
 *
 * @author lirongqian
 * @since 2018/10/22
 */
@Configuration
@Slf4j
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * redis序列化配置，使用lettuce客户端
     */
    @Bean
    public &lt;T&gt; RedisTemplate&lt;String, T&gt; redisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, T&gt; template = new RedisTemplate&lt;&gt;();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new GenericFastJsonRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Bean
    public StringRedisTemplate stringRedisTemplate(LettuceConnectionFactory redisConnectionFactory) {
        StringRedisTemplate template = new StringRedisTemplate();
        template.setKeySerializer(new PrefixRedisSerializer());
        template.setValueSerializer(new StringRedisSerializer());
        template.setConnectionFactory(redisConnectionFactory);
        template.setHashKeySerializer(new StringRedisSerializer());
        template.setHashValueSerializer(new StringRedisSerializer());
        template.afterPropertiesSet();
        return template;
    }

    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {
            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                log.warn("获取缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                log.warn("handleCachePutError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                log.warn("handleCacheEvictError缓存时异常---key: " + key + " 异常信息:" + e);
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("清除缓存时异常--- 异常信息:" + e);
            }
        };
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="16" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.232</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> PrefixRedisSerializer.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-user\src\main\java\com\stalary\pf\user\config\PrefixRedisSerializer.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">

package com.stalary.pf.user.config;

import com.stalary.pf.user.data.constant.Constant;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.redis.serializer.RedisSerializer;
import org.springframework.stereotype.Component;
import org.springframework.util.Assert;

import java.nio.charset.Charset;

/**
 * PrefixRedisSerializer
 *
 * @author lirongqian
 * @since 2018/10/21
 */
@Component
@Slf4j
public class PrefixRedisSerializer implements RedisSerializer&lt;String&gt; {

    private String prefix = "pf";

    private final Charset charset;

    public PrefixRedisSerializer() {
        this(Charset.forName("UTF8"));
    }

    public PrefixRedisSerializer(Charset charset) {
        Assert.notNull(charset, "Charset must not be null!");
        this.charset = charset;
    }


    @Override
    public String deserialize(byte[] bytes) {
        String saveKey = new String(bytes, charset);
        int indexOf = saveKey.indexOf(prefix);
        if (indexOf &gt; 0) {
            log.warn("key缺少前缀");
        } else {
            saveKey = saveKey.substring(indexOf + prefix.length() + 1);
        }
        return saveKey;
    }

    @Override
    public byte[] serialize(String string) {
        String key = prefix + Constant.SPLIT + string;
        return key.getBytes(charset);
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="17" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.234</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> NetworkDisk</a><br />
                                    <b> <a> File: </a> </b>  <a> CoreZuulApplication.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pan-core-service\pan-core-zuul\src\main\java\top\quhailong\pan\core\zuul\CoreZuulApplication.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package top.quhailong.pan.core.zuul;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;
import org.springframework.context.annotation.Bean;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import org.springframework.web.filter.CorsFilter;

/**
 * 登录、注册网关
 * @author 屈海龙
 *
 */
@EnableZuulProxy
@EnableDiscoveryClient
@SpringBootApplication
public class CoreZuulApplication {

	public static void main(String[] args) {
		SpringApplication.run(CoreZuulApplication.class, args);
	}
	@Bean
    public CorsFilter corsFilter() {
		final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        final CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true); // 允许cookies跨域
        //config.addAllowedOrigin("http://regist.727pan.cn");// #允许向该服务器提交请求的URI，*表示全部允许，在SpringMVC中，如果设成*，会自动转成当前请求头中的Origin
        //config.addAllowedOrigin("http://727pan.cn");// #允许向该服务器提交请求的URI，*表示全部允许，在SpringMVC中，如果设成*，会自动转成当前请求头中的Origin
        config.addAllowedOrigin("*");// #允许向该服务器提交请求的URI，*表示全部允许，在SpringMVC中，如果设成*，会自动转成当前请求头中的Origin
        config.addAllowedHeader("*");// #允许访问的头信息,*表示全部
        config.addAllowedMethod("*");// 允许提交请求的方法，*表示全部允许
        source.registerCorsConfiguration("/**", config);
        return new CorsFilter(source);
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="18" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.236</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> NetworkDisk</a><br />
                                    <b> <a> File: </a> </b>  <a> FileZuulApplication.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pan-file-service\pan-file-zuul\src\main\java\top\quhailong\pan\file\zuul\FileZuulApplication.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package top.quhailong.pan.file.zuul;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;
import org.springframework.context.annotation.Bean;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import org.springframework.web.filter.CorsFilter;

/**
 * 系统核心网关
 * @author 屈海龙
 *
 */
@SpringBootApplication
@EnableEurekaClient
@EnableZuulProxy
public class FileZuulApplication {

	public static void main(String[] args) {
		SpringApplication.run(FileZuulApplication.class, args);
	}
	@Bean
    public CorsFilter corsFilter() {
		final UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        final CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true); // 允许cookies跨域
        //config.addAllowedOrigin("http://localhost:8082");// #允许向该服务器提交请求的URI，*表示全部允许，在SpringMVC中，如果设成*，会自动转成当前请求头中的Origin
        config.addAllowedOrigin("*");// #允许向该服务器提交请求的URI，*表示全部允许，在SpringMVC中，如果设成*，会自动转成当前请求头中的Origin
        config.addAllowedHeader("*");// #允许访问的头信息,*表示全部
        config.addAllowedMethod("*");// 允许提交请求的方法，*表示全部允许
        source.registerCorsConfiguration("/**", config);
        return new CorsFilter(source);
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="19" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.238</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> simplemall</a><br />
                                    <b> <a> File: </a> </b>  <a> DruidDataSourceConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>account-sevice\src\main\java\com\simplemall\account\config\DruidDataSourceConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.simplemall.account.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableConfigurationProperties(DataSourceProperties.class)
public class DruidDataSourceConfig {

    private static Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);

    @Autowired
    private DataSourceProperties dataSourceProperties;

    @Bean
    @Primary
    public DataSource druidDataSource(){
        DruidDataSource datasource = new DruidDataSource();

        datasource.setUrl(dataSourceProperties.getUrl());
        datasource.setUsername(dataSourceProperties.getUsername());
        datasource.setPassword(dataSourceProperties.getPassword());
        datasource.setDriverClassName(dataSourceProperties.getDriverClassName());
        datasource.setInitialSize(dataSourceProperties.getInitialSize());
        datasource.setMinIdle(dataSourceProperties.getMinIdle());
        datasource.setMaxActive(dataSourceProperties.getMaxActive());
        datasource.setMaxWait(dataSourceProperties.getMaxWait());
        datasource.setTimeBetweenEvictionRunsMillis(dataSourceProperties.getTimeBetweenEvictionRunsMillis());
        datasource.setMinEvictableIdleTimeMillis(dataSourceProperties.getMinEvictableIdleTimeMillis());
        datasource.setValidationQuery(dataSourceProperties.getValidationQuery());
        datasource.setTestWhileIdle(dataSourceProperties.isTestWhileIdle());
        datasource.setTestOnBorrow(dataSourceProperties.isTestOnBorrow());
        datasource.setTestOnReturn(dataSourceProperties.isTestOnReturn());
        datasource.setPoolPreparedStatements(dataSourceProperties.isPoolPreparedStatements());
        try {
            datasource.setFilters(dataSourceProperties.getFilters());
        } catch (SQLException e) {
            logger.error("Druid configuration initialization filter error.", e);
        }
        return datasource;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="20" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.239</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> simplemall</a><br />
                                    <b> <a> File: </a> </b>  <a> DruidDataSourceConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>msg-service\src\main\java\com\simplemall\micro\serv\msg\config\DruidDataSourceConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.simplemall.micro.serv.msg.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableConfigurationProperties(DataSourceProperties.class)
public class DruidDataSourceConfig {

    private static Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);

    @Autowired
    private DataSourceProperties dataSourceProperties;

    @Bean
    @Primary
    public DataSource druidDataSource(){
        DruidDataSource datasource = new DruidDataSource();

        datasource.setUrl(dataSourceProperties.getUrl());
        datasource.setUsername(dataSourceProperties.getUsername());
        datasource.setPassword(dataSourceProperties.getPassword());
        datasource.setDriverClassName(dataSourceProperties.getDriverClassName());
        datasource.setInitialSize(dataSourceProperties.getInitialSize());
        datasource.setMinIdle(dataSourceProperties.getMinIdle());
        datasource.setMaxActive(dataSourceProperties.getMaxActive());
        datasource.setMaxWait(dataSourceProperties.getMaxWait());
        datasource.setTimeBetweenEvictionRunsMillis(dataSourceProperties.getTimeBetweenEvictionRunsMillis());
        datasource.setMinEvictableIdleTimeMillis(dataSourceProperties.getMinEvictableIdleTimeMillis());
        datasource.setValidationQuery(dataSourceProperties.getValidationQuery());
        datasource.setTestWhileIdle(dataSourceProperties.isTestWhileIdle());
        datasource.setTestOnBorrow(dataSourceProperties.isTestOnBorrow());
        datasource.setTestOnReturn(dataSourceProperties.isTestOnReturn());
        datasource.setPoolPreparedStatements(dataSourceProperties.isPoolPreparedStatements());
        try {
            datasource.setFilters(dataSourceProperties.getFilters());
        } catch (SQLException e) {
            logger.error("Druid configuration initialization filter error.", e);
        }
        return datasource;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="21" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.240</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> simplemall</a><br />
                                    <b> <a> File: </a> </b>  <a> DruidDataSourceConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>order-service\src\main\java\com\simplemall\micro\serv\order\config\DruidDataSourceConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.simplemall.micro.serv.order.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableConfigurationProperties(DataSourceProperties.class)
public class DruidDataSourceConfig {

    private static Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);

    @Autowired
    private DataSourceProperties dataSourceProperties;

    @Bean
    @Primary
    public DataSource druidDataSource(){
        DruidDataSource datasource = new DruidDataSource();

        datasource.setUrl(dataSourceProperties.getUrl());
        datasource.setUsername(dataSourceProperties.getUsername());
        datasource.setPassword(dataSourceProperties.getPassword());
        datasource.setDriverClassName(dataSourceProperties.getDriverClassName());
        datasource.setInitialSize(dataSourceProperties.getInitialSize());
        datasource.setMinIdle(dataSourceProperties.getMinIdle());
        datasource.setMaxActive(dataSourceProperties.getMaxActive());
        datasource.setMaxWait(dataSourceProperties.getMaxWait());
        datasource.setTimeBetweenEvictionRunsMillis(dataSourceProperties.getTimeBetweenEvictionRunsMillis());
        datasource.setMinEvictableIdleTimeMillis(dataSourceProperties.getMinEvictableIdleTimeMillis());
        datasource.setValidationQuery(dataSourceProperties.getValidationQuery());
        datasource.setTestWhileIdle(dataSourceProperties.isTestWhileIdle());
        datasource.setTestOnBorrow(dataSourceProperties.isTestOnBorrow());
        datasource.setTestOnReturn(dataSourceProperties.isTestOnReturn());
        datasource.setPoolPreparedStatements(dataSourceProperties.isPoolPreparedStatements());
        try {
            datasource.setFilters(dataSourceProperties.getFilters());
        } catch (SQLException e) {
            logger.error("Druid configuration initialization filter error.", e);
        }
        return datasource;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="22" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.241</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> simplemall</a><br />
                                    <b> <a> File: </a> </b>  <a> DruidDataSourceConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>payment-service\src\main\java\com\simplemall\pay\config\DruidDataSourceConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.simplemall.pay.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableConfigurationProperties(DataSourceProperties.class)
public class DruidDataSourceConfig {

    private static Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);

    @Autowired
    private DataSourceProperties dataSourceProperties;

    @Bean
    @Primary
    public DataSource druidDataSource(){
        DruidDataSource datasource = new DruidDataSource();

        datasource.setUrl(dataSourceProperties.getUrl());
        datasource.setUsername(dataSourceProperties.getUsername());
        datasource.setPassword(dataSourceProperties.getPassword());
        datasource.setDriverClassName(dataSourceProperties.getDriverClassName());
        datasource.setInitialSize(dataSourceProperties.getInitialSize());
        datasource.setMinIdle(dataSourceProperties.getMinIdle());
        datasource.setMaxActive(dataSourceProperties.getMaxActive());
        datasource.setMaxWait(dataSourceProperties.getMaxWait());
        datasource.setTimeBetweenEvictionRunsMillis(dataSourceProperties.getTimeBetweenEvictionRunsMillis());
        datasource.setMinEvictableIdleTimeMillis(dataSourceProperties.getMinEvictableIdleTimeMillis());
        datasource.setValidationQuery(dataSourceProperties.getValidationQuery());
        datasource.setTestWhileIdle(dataSourceProperties.isTestWhileIdle());
        datasource.setTestOnBorrow(dataSourceProperties.isTestOnBorrow());
        datasource.setTestOnReturn(dataSourceProperties.isTestOnReturn());
        datasource.setPoolPreparedStatements(dataSourceProperties.isPoolPreparedStatements());
        try {
            datasource.setFilters(dataSourceProperties.getFilters());
        } catch (SQLException e) {
            logger.error("Druid configuration initialization filter error.", e);
        }
        return datasource;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="23" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.242</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> simplemall</a><br />
                                    <b> <a> File: </a> </b>  <a> DruidDataSourceConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>product-service\src\main\java\com\simplemall\micro\serv\prd\config\DruidDataSourceConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.simplemall.micro.serv.prd.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

import javax.sql.DataSource;
import java.sql.SQLException;

@Configuration
@EnableConfigurationProperties(DataSourceProperties.class)
public class DruidDataSourceConfig {

    private static Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);

    @Autowired
    private DataSourceProperties dataSourceProperties;

    @Bean
    @Primary
    public DataSource druidDataSource(){
        DruidDataSource datasource = new DruidDataSource();

        datasource.setUrl(dataSourceProperties.getUrl());
        datasource.setUsername(dataSourceProperties.getUsername());
        datasource.setPassword(dataSourceProperties.getPassword());
        datasource.setDriverClassName(dataSourceProperties.getDriverClassName());
        datasource.setInitialSize(dataSourceProperties.getInitialSize());
        datasource.setMinIdle(dataSourceProperties.getMinIdle());
        datasource.setMaxActive(dataSourceProperties.getMaxActive());
        datasource.setMaxWait(dataSourceProperties.getMaxWait());
        datasource.setTimeBetweenEvictionRunsMillis(dataSourceProperties.getTimeBetweenEvictionRunsMillis());
        datasource.setMinEvictableIdleTimeMillis(dataSourceProperties.getMinEvictableIdleTimeMillis());
        datasource.setValidationQuery(dataSourceProperties.getValidationQuery());
        datasource.setTestWhileIdle(dataSourceProperties.isTestWhileIdle());
        datasource.setTestOnBorrow(dataSourceProperties.isTestOnBorrow());
        datasource.setTestOnReturn(dataSourceProperties.isTestOnReturn());
        datasource.setPoolPreparedStatements(dataSourceProperties.isPoolPreparedStatements());
        try {
            datasource.setFilters(dataSourceProperties.getFilters());
        } catch (SQLException e) {
            logger.error("Druid configuration initialization filter error.", e);
        }
        return datasource;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="24" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.249</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> CartSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-cart\src\main\java\com\jerusalem\cart\config\CartSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.cart.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class CartSentinelConfig {

    public CartSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="25" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.251</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> CouponSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-coupon\src\main\java\com\jerusalem\coupon\config\CouponSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.coupon.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class CouponSentinelConfig {

    public CouponSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="26" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.252</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> GoodsSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-goods\src\main\java\com\jerusalem\goods\config\GoodsSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.goods.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class GoodsSentinelConfig {

    public GoodsSentinelConfig(){

        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="27" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.253</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> Oauth2SentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-oauth2\src\main\java\com\jerusalem\oauth2\config\Oauth2SentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.oauth2.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class Oauth2SentinelConfig {

    public Oauth2SentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="28" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.254</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> OrderSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-order\src\main\java\com\jerusalem\order\config\OrderSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.order.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class OrderSentinelConfig {

    public OrderSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="29" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.256</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> SearchSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-search\src\main\java\com\jerusalem\search\config\SearchSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.search.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class SearchSentinelConfig {

    public SearchSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="30" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.257</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> SeckillSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-seckill\src\main\java\com\jerusalem\seckill\config\SeckillSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.seckill.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class SeckillSentinelConfig {

    public SeckillSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="31" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.259</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> ThirdSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-third-services\src\main\java\com\jerusalem\third\config\ThirdSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.third.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class ThirdSentinelConfig {

    public ThirdSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="32" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.260</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> UserSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-user\src\main\java\com\jerusalem\user\config\UserSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.user.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class UserSentinelConfig {

    public UserSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="33" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.261</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> WareSentinelConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-ware\src\main\java\com\jerusalem\ware\config\WareSentinelConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.ware.config;

import com.alibaba.csp.sentinel.adapter.servlet.callback.UrlBlockHandler;
import com.alibaba.csp.sentinel.adapter.servlet.callback.WebCallbackManager;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.alibaba.fastjson.JSON;
import com.jerusalem.common.exception.BizCodeEnume;
import com.jerusalem.common.utils.R;
import org.springframework.context.annotation.Configuration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/****
 * @Author: jerusalem
 * @Description: SeckillSentinelConfig
 * 自定义流控响应
 * @Date 2020/11/20 16:48
 *****/
@Configuration
public class WareSentinelConfig {

    public WareSentinelConfig(){
        WebCallbackManager.setUrlBlockHandler(new UrlBlockHandler() {
            @Override
            public void blocked(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e) throws IOException {
                R error = R.error(BizCodeEnume.TOO_MANY_REQUEST.getCode(), BizCodeEnume.TOO_MANY_REQUEST.getMsg());
                httpServletResponse.setCharacterEncoding("UTF-8");
                httpServletResponse.setContentType("application");
                httpServletResponse.getWriter().write(JSON.toJSONString(error));
            }
        });
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="34" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.265</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> WebMvcConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-account-service\src\main\java\com\wanxin\account\config\WebMvcConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.account.config;

import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.text.SimpleDateFormat;
import java.util.List;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Configuration
public class WebMvcConfiguration implements WebMvcConfigurer {
    /**
     * 定义时间格式以及类型转换 转换器
     *
     * @return
     */
    @Bean
    public MappingJackson2HttpMessageConverter jackson2HttpMessageConverter() {
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        ObjectMapper mapper = new ObjectMapper();
        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        mapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));

        SimpleModule simpleModule = new SimpleModule();
        simpleModule.addSerializer(Long.class, ToStringSerializer.instance);
        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);
        mapper.registerModule(simpleModule);

        converter.setObjectMapper(mapper);
        return converter;
    }

    /**
     * 添加转换器
     *
     * @param converters
     */
    @Override
    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {
        converters.add(jackson2HttpMessageConverter());
    }

    /**
     * 添加静态资源文件, 外部可以直接访问地址
     *
     * @param registry
     */
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/**").addResourceLocations("classpath:/static/");

        // 解决swagger无法访问
        registry
                .addResourceHandler("/swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/");
        // 解决swagger的js文件无法访问
        registry
                .addResourceHandler("/webjars/**")
                .addResourceLocations("classpath:/META-INF/resources/webjars/");
        registry
                .addResourceHandler("doc.html")
                .addResourceLocations("classpath:/META-INF/resources/");
    }
}



</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="35" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.270</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> WebMvcConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\config\WebMvcConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.config;

import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
import com.wanxin.consumer.interceptor.TokenInterceptor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.text.SimpleDateFormat;
import java.util.List;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Configuration
public class WebMvcConfiguration implements WebMvcConfigurer {

    /**
     * 添加自定义拦截器
     *
     * @param registry 拦截器注册对象
     */
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new TokenInterceptor()).addPathPatterns("/**");
    }

    /**
     * 定义时间格式以及类型转换 转换器
     *
     * @return
     */
    @Bean
    public MappingJackson2HttpMessageConverter jackson2HttpMessageConverter() {
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        ObjectMapper mapper = new ObjectMapper();
        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        mapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));

        SimpleModule simpleModule = new SimpleModule();
        simpleModule.addSerializer(Long.class, ToStringSerializer.instance);
        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);
        mapper.registerModule(simpleModule);

        converter.setObjectMapper(mapper);
        return converter;
    }

    /**
     * 添加转换器
     *
     * @param converters
     */
    @Override
    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {
        converters.add(jackson2HttpMessageConverter());

    }

    /**
     * 添加静态资源文件, 外部可以直接访问地址
     *
     * @param registry
     */
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/**").addResourceLocations("classpath:/static/");

        // 解决swagger无法访问
        registry
                .addResourceHandler("/swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/");
        // 解决swagger的js文件无法访问
        registry
                .addResourceHandler("/webjars/**")
                .addResourceLocations("classpath:/META-INF/resources/webjars/");
        registry
                .addResourceHandler("doc.html")
                .addResourceLocations("classpath:/META-INF/resources/");
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="36" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.280</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> WebConfig.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-transaction-service\src\main\java\com\wanxin\transaction\config\WebConfig.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.transaction.config;

import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
import com.wanxin.transaction.interceptor.TokenInterceptor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.text.SimpleDateFormat;
import java.util.List;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Configuration
public class WebConfig implements WebMvcConfigurer {
    /**
     * 添加自定义拦截器
     *
     * @param registry 拦截器注册对象
     */
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new TokenInterceptor()).addPathPatterns("/**");
    }

    /**
     * 定义时间格式以及类型转换 转换器
     *
     * @return
     */
    @Bean
    public MappingJackson2HttpMessageConverter jackson2HttpMessageConverter() {
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        ObjectMapper mapper = new ObjectMapper();
        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        mapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));

        SimpleModule simpleModule = new SimpleModule();
        simpleModule.addSerializer(Long.class, ToStringSerializer.instance);
        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);
        mapper.registerModule(simpleModule);

        converter.setObjectMapper(mapper);
        return converter;
    }

    /**
     * 添加转换器
     *
     * @param converters
     */
    @Override
    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {
        converters.add(jackson2HttpMessageConverter());
    }

    /**
     * 添加静态资源文件, 外部可以直接访问地址
     *
     * @param registry
     */
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/**").addResourceLocations("classpath:/static/");

        // 解决swagger无法访问
        registry
                .addResourceHandler("/swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/");
        // 解决swagger的js文件无法访问
        registry
                .addResourceHandler("/webjars/**")
                .addResourceLocations("classpath:/META-INF/resources/webjars/");
        registry
                .addResourceHandler("doc.html")
                .addResourceLocations("classpath:/META-INF/resources/");
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="37" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.284</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-oms\oms-boot\src\main\java\com\youlai\mall\oms\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.mall.oms.config;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
public class SwaggerConfiguration {

    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.mall.oms.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("订单中心")
                .description("&lt;div style='font-size:14px;color:red;'&gt;订单提交、秒杀接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="38" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.285</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-pms\pms-boot\src\main\java\com\youlai\mall\pms\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.mall.pms.config;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
public class SwaggerConfiguration {

    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.mall.pms.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("商品中心")
                .description("&lt;div style='font-size:14px;color:red;'&gt;商品管理、库存、分类、品牌、规格、参数等接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="39" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.286</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-sms\sms-boot\src\main\java\com\youlai\mall\sms\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.mall.sms.config;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
public class SwaggerConfiguration {

    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.mall.sms.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder().title("营销中心")
                .description("&lt;div style='font-size:14px;color:red;'&gt;首页广告接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="40" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.287</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-ums\ums-boot\src\main\java\com\youlai\mall\ums\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.mall.ums.config;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
public class SwaggerConfiguration {


    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.mall.ums.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("会员中心")
                .description("&lt;div style='font-size:14px;color:red;'&gt;会员管理、地址接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="41" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.288</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>youlai-admin\admin-boot\src\main\java\com\youlai\admin\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.admin.config;

import com.google.common.collect.Lists;
import lombok.extern.slf4j.Slf4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
@Slf4j
public class SwaggerConfiguration {

    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.admin.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("系统管理")
                .description("&lt;div style='font-size:14px;color:red;'&gt;用户、角色、部门、菜单、权限、字典、客户端接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="42" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.289</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>youlai-auth\src\main\java\com\youlai\auth\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.auth.config;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author haoxr
 * @Date 2021-02-25 15:36
 * @Version 1.0.0
 */
@Configuration
@EnableSwagger2WebMvc
public class SwaggerConfiguration {

    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.auth.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder().title("OAuth2认证中心")
                .description("&lt;div style='font-size:14px;color:red;'&gt;OAuth2认证、注销、获取验签公钥接口&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="43" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.290</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> youlai</a><br />
                                    <b> <a> File: </a> </b>  <a> SwaggerConfiguration.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Config File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>youlai-laboratory\src\main\java\com\youlai\laboratory\base\config\SwaggerConfiguration.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.youlai.laboratory.base.config;

import lombok.extern.slf4j.Slf4j;

import com.google.common.collect.Lists;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.OAuthBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.*;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spi.service.contexts.SecurityContext;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * @author &lt;a href="mailto:2256222053@qq.com"&gt;zc&lt;/a&gt;
 * @data 2021/11/28 0028 11:19
 */
@Configuration
@EnableSwagger2WebMvc
@Import(BeanValidatorPluginsConfiguration.class)
@Slf4j
public class SwaggerConfiguration {
    @Bean
    public Docket restApi() {
        //schema
        List&lt;GrantType&gt; grantTypes=new ArrayList&lt;&gt;();
        //密码模式
        String passwordTokenUrl="http://localhost:9999/youlai-auth/oauth/token";
        ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant=new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl);
        grantTypes.add(resourceOwnerPasswordCredentialsGrant);
        OAuth oAuth=new OAuthBuilder().name("oauth2")
                .grantTypes(grantTypes).build();
        //context
        //scope方位
        List&lt;AuthorizationScope&gt; scopes=new ArrayList&lt;&gt;();
        scopes.add(new AuthorizationScope("read","read  resources"));
        scopes.add(new AuthorizationScope("write","write resources"));
        scopes.add(new AuthorizationScope("reads","read all resources"));
        scopes.add(new AuthorizationScope("writes","write all resources"));

        SecurityReference securityReference=new SecurityReference("oauth2",scopes.toArray(new AuthorizationScope[]{}));
        SecurityContext securityContext=new SecurityContext(Lists.newArrayList(securityReference),PathSelectors.ant("/**"));
        //schemas
        List&lt;SecurityScheme&gt; securitySchemes=Lists.newArrayList(oAuth);
        //securyContext
        List&lt;SecurityContext&gt; securityContexts=Lists.newArrayList(securityContext);
        return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors.basePackage("com.youlai.laboratory.**.controller"))
                .paths(PathSelectors.any())
                .build()
                .securityContexts(securityContexts)
                .securitySchemes(securitySchemes)
                .apiInfo(apiInfo());
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("系统管理")
                .description("&lt;div style='font-size:14px;color:red;'&gt;提供学习canal,elasticsearch,jvm,mybatis,mysql,netty,rabbitmq,redis,seata,sentinel,spring的环境&lt;/div&gt;")
                .termsOfServiceUrl("https://www.youlai.tech")
                .contact(new Contact("有来技术团队", "https://github.com/hxrui", "1490493387@qq.com"))
                .license("Open Source")
                .licenseUrl("https://www.apache.org/licenses/LICENSE-2.0")
                .version("1.0.0")
                .build();
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div>
                            <div id="divpager-1"></div>
                        </div>

                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-card" id="44" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.219</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> ExceptionHandle.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-message\src\main\java\com\stalary\pf\message\exception\ExceptionHandle.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.stalary.pf.message.exception;

import com.stalary.pf.message.data.vo.ResponseMessage;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.PrintWriter;
import java.io.StringWriter;

/**
 * @author Stalary
 * @description
 * @date 2018/04/14
 */
@ControllerAdvice
@Slf4j
public class ExceptionHandle {

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public ResponseMessage handle(Exception e) {
        if (e instanceof MyException) {
            MyException myException = (MyException) e;
            return ResponseMessage.error(myException.getCode(), myException.getMessage());
        } else {
            log.error("[系统异常]", e);
            StringWriter sw = new StringWriter();
            e.printStackTrace(new PrintWriter(sw));
            return ResponseMessage.error(500, "message 运行时异常！" + sw.toString());
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="45" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.222</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> ExceptionHandle.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-outside\src\main\java\com\stalary\pf\outside\exception\ExceptionHandle.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.stalary.pf.outside.exception;

import com.stalary.pf.outside.data.ResponseMessage;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.PrintWriter;
import java.io.StringWriter;

/**
 * @author Stalary
 * @description
 * @date 2018/04/14
 */
@ControllerAdvice
@Slf4j
public class ExceptionHandle {

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public ResponseMessage handle(Exception e) {
        if (e instanceof MyException) {
            MyException myException = (MyException) e;
            return ResponseMessage.error(myException.getCode(), myException.getMessage());
        } else {
            log.error("[系统异常]", e);
            StringWriter sw = new StringWriter();
            e.printStackTrace(new PrintWriter(sw));
            return ResponseMessage.error(500, "outside 运行时异常！" + sw.toString());
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="46" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.227</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> ExceptionHandle.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-recruit\src\main\java\com\stalary\pf\recruit\exception\ExceptionHandle.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.stalary.pf.recruit.exception;

import com.stalary.pf.recruit.data.vo.ResponseMessage;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.PrintWriter;
import java.io.StringWriter;

/**
 * @author Stalary
 * @description
 * @date 2018/04/14
 */
@ControllerAdvice
@Slf4j
public class ExceptionHandle {

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public ResponseMessage handle(Exception e) {
        if (e instanceof MyException) {
            MyException myException = (MyException) e;
            return ResponseMessage.error(myException.getCode(), myException.getMessage());
        } else {
            log.error("[系统异常]", e);
            StringWriter sw = new StringWriter();
            e.printStackTrace(new PrintWriter(sw));
            return ResponseMessage.error(500, "recruit 运行时异常！" + sw.toString());
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="47" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.230</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> ExceptionHandle.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-resume\src\main\java\com\stalary\pf\resume\exception\ExceptionHandle.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.stalary.pf.resume.exception;

import com.stalary.pf.resume.data.vo.ResponseMessage;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.PrintWriter;
import java.io.StringWriter;

/**
 * @author Stalary
 * @description
 * @date 2018/04/14
 */
@ControllerAdvice
@Slf4j
public class ExceptionHandle {

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public ResponseMessage handle(Exception e) {
        if (e instanceof MyException) {
            MyException myException = (MyException) e;
            return ResponseMessage.error(myException.getCode(), myException.getMessage());
        } else {
            log.error("[系统异常]", e);
            StringWriter sw = new StringWriter();
            e.printStackTrace(new PrintWriter(sw));
            return ResponseMessage.error(500, "resume 运行时异常！" + sw.toString());
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="48" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.233</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> recruit</a><br />
                                    <b> <a> File: </a> </b>  <a> ExceptionHandle.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pf-user\src\main\java\com\stalary\pf\user\exception\ExceptionHandle.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.stalary.pf.user.exception;

import com.stalary.pf.user.data.vo.ResponseMessage;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.PrintWriter;
import java.io.StringWriter;

/**
 * @author Stalary
 * @description
 * @date 2018/04/14
 */
@ControllerAdvice
@Slf4j
public class ExceptionHandle {

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public ResponseMessage handle(Exception e) {
        if (e instanceof MyException) {
            MyException myException = (MyException) e;
            return ResponseMessage.error(myException.getCode(), myException.getMessage());
        } else {
            log.error("[系统异常]", e);
            StringWriter sw = new StringWriter();
            e.printStackTrace(new PrintWriter(sw));
            return ResponseMessage.error(500, "user 运行时异常！" + sw.toString());
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="49" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.264</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-account-service\src\main\java\com\wanxin\account\common\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.account.common;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.lang.Nullable;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(value = Exception.class)
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }

        log.error("[系统异常]-" + e.getMessage());
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="50" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.268</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\common\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.common;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.lang.Nullable;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Slf4j
@ControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }

        log.error("[系统异常]-" + e.getMessage());
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="51" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.274</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-content-search-service\src\main\java\com\wanxin\search\common\intercept\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.search.common.intercept;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.lang.Nullable;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@ControllerAdvice
public class GlobalExceptionHandler {

    private final static Logger LOGGER = LoggerFactory.getLogger(GlobalExceptionHandler.class);

    @ExceptionHandler(value = Exception.class)
    @ResponseBody
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }

        LOGGER.error("[系统异常]-{}", e);
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="52" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.275</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-depository-agent-service\src\main\java\com\wanxin\depository\common\intercept\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.depository.common.intercept;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.lang.Nullable;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @since 1.8
 */
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(value = Exception.class)
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }
        log.error("[系统异常]-{}", e);
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="53" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.278</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-transaction-service\src\main\java\com\wanxin\transaction\common\intercept\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.transaction.common.intercept;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import lombok.extern.slf4j.Slf4j;
import org.springframework.lang.Nullable;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(value = Exception.class)
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }

        log.error("[系统异常]-{}", e);
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="54" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.282</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> GlobalExceptionHandler.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Exception Handling File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-uaa-service\src\main\java\com\wanxin\uaa\common\intercept\GlobalExceptionHandler.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.uaa.common.intercept;

import com.wanxin.common.domain.BusinessException;
import com.wanxin.common.domain.CommonErrorCode;
import com.wanxin.common.domain.RestResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.lang.Nullable;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.servlet.NoHandlerFoundException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
@RestControllerAdvice
public class GlobalExceptionHandler {

    private final static Logger LOGGER = LoggerFactory.getLogger(GlobalExceptionHandler.class);

    @ExceptionHandler(value = Exception.class)
    public RestResponse&lt;Nullable&gt; exceptionGet(HttpServletRequest req, HttpServletResponse response, Exception e) {
        if (e instanceof BusinessException) {
            BusinessException be = (BusinessException) e;
            if (CommonErrorCode.CUSTOM.equals(be.getErrorCode())) {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getMessage());
            } else {
                return new RestResponse&lt;Nullable&gt;(be.getErrorCode().getCode(), be.getErrorCode().getDesc());
            }

        } else if (e instanceof NoHandlerFoundException) {
            return new RestResponse&lt;Nullable&gt;(404, "找不到资源");
        } else if (e instanceof HttpRequestMethodNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(405, "method 方法不支持");
        } else if (e instanceof AccessDeniedException) {
            return new RestResponse&lt;Nullable&gt;(304, "没有权限访问");
        } else if (e instanceof HttpMediaTypeNotSupportedException) {
            return new RestResponse&lt;Nullable&gt;(415, "不支持媒体类型");
        }

        LOGGER.error("[系统异常]-{0}", e);
        return new RestResponse&lt;Nullable&gt;(CommonErrorCode.UNKOWN.getCode(), CommonErrorCode.UNKOWN.getDesc());
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div>
                            <div id="divpager-2"></div>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-card" id="55" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.217</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> swarm</a><br />
                                    <b> <a> File: </a> </b>  <a> FlagValidatorClass.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-admin\src\main\java\com\macro\mall\validator\FlagValidatorClass.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.macro.mall.validator;

import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;

/**
 * 状态标记校验器
 * Created by macro on 2018/4/26.
 */
public class FlagValidatorClass implements ConstraintValidator&lt;FlagValidator,Integer&gt; {
    private String[] values;
    @Override
    public void initialize(FlagValidator flagValidator) {
        this.values = flagValidator.value();
    }

    @Override
    public boolean isValid(Integer value, ConstraintValidatorContext constraintValidatorContext) {
        boolean isValid = false;
        if(value==null){
            //当状态为空时使用默认值
            return true;
        }
        for(int i=0;i&lt;values.length;i++){
            if(values[i].equals(String.valueOf(value))){
                isValid = true;
                break;
            }
        }
        return isValid;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="56" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.262</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> train-ticket</a><br />
                                    <b> <a> File: </a> </b>  <a> CookieUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>ts-inside-payment-service\src\main\java\inside_payment\util\CookieUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package inside_payment.util;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.util.HashMap;
import java.util.Map;

/**
 * @author fdse
 */
public class CookieUtil {

    private CookieUtil() {
        throw new IllegalStateException("Utility class");
    }

    public static void addCookie(HttpServletResponse response, String name, String value, int maxAge){
        Cookie cookie = new Cookie(name,value);
        // against Cross-Site Scripting (XSS) attacks
        cookie.setHttpOnly(true);
        cookie.setPath("/");
        if(maxAge&gt;0) {
            cookie.setMaxAge(maxAge);
        }
        response.addCookie(cookie);
    }

    public static Cookie getCookieByName(HttpServletRequest request, String name){
        Map&lt;String,Cookie&gt; cookieMap = readCookieMap(request);
        if(cookieMap.containsKey(name)){
            return cookieMap.get(name);
        }else{
            return null;
        }
    }

    private static Map&lt;String,Cookie&gt; readCookieMap(HttpServletRequest request){
        Map&lt;String,Cookie&gt; cookieMap = new HashMap&lt;&gt;();
        Cookie[] cookies = request.getCookies();
        if(null!=cookies){
            for(Cookie cookie : cookies){
                cookieMap.put(cookie.getName(), cookie);
            }
        }
        return cookieMap;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="57" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.263</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> train-ticket</a><br />
                                    <b> <a> File: </a> </b>  <a> CookieUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>ts-verification-code-service\src\main\java\verifycode\util\CookieUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package verifycode.util;

import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.util.HashMap;
import java.util.Map;

/**
 * @author fdse
 */
public class CookieUtil {

    private CookieUtil() {
        throw new IllegalStateException("Utility class");
    }

    public static void addCookie(HttpServletResponse response, String name, String value, int maxAge){
        Cookie cookie = new Cookie(name,value);
        // against Cross-Site Scripting (XSS) attacks.
        cookie.setHttpOnly(true);
        cookie.setPath("/");
        if(maxAge&gt;0) {
            cookie.setMaxAge(maxAge);
        }
        response.addCookie(cookie);
    }

    public static Cookie getCookieByName(HttpServletRequest request, String name){
        Map&lt;String,Cookie&gt; cookieMap = readCookieMap(request);
        return cookieMap.getOrDefault(name, null);
    }

    private static Map&lt;String,Cookie&gt; readCookieMap(HttpServletRequest request){
        Map&lt;String,Cookie&gt; cookieMap = new HashMap&lt;&gt;();
        Cookie[] cookies = request.getCookies();
        if(null!=cookies){
            for(Cookie cookie : cookies){
                cookieMap.put(cookie.getName(), cookie);
            }
        }
        return cookieMap;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="58" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.266</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> Base64Util.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-common\src\main\java\com\wanxin\common\util\Base64Util.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.common.util;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class Base64Util {
    private static final char last2byte = (char) Integer.parseInt("00000011", 2);
    private static final char last4byte = (char) Integer.parseInt("00001111", 2);
    private static final char last6byte = (char) Integer.parseInt("00111111", 2);
    private static final char lead6byte = (char) Integer.parseInt("11111100", 2);
    private static final char lead4byte = (char) Integer.parseInt("11110000", 2);
    private static final char lead2byte = (char) Integer.parseInt("11000000", 2);
    private static final char[] encodeTable = new char[]{'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/'};

    public Base64Util() {
    }

    public static String encode(byte[] from) {
        StringBuilder to = new StringBuilder((int) ((double) from.length * 1.34D) + 3);
        int num = 0;
        char currentByte = 0;

        int i;
        for (i = 0; i &lt; from.length; ++i) {
            for (num %= 8; num &lt; 8; num += 6) {
                switch (num) {
                    case 0:
                        currentByte = (char) (from[i] & lead6byte);
                        currentByte = (char) (currentByte &gt;&gt;&gt; 2);
                    case 1:
                    case 3:
                    case 5:
                    default:
                        break;
                    case 2:
                        currentByte = (char) (from[i] & last6byte);
                        break;
                    case 4:
                        currentByte = (char) (from[i] & last4byte);
                        currentByte = (char) (currentByte &lt;&lt; 2);
                        if (i + 1 &lt; from.length) {
                            currentByte = (char) (currentByte | (from[i + 1] & lead2byte) &gt;&gt;&gt; 6);
                        }
                        break;
                    case 6:
                        currentByte = (char) (from[i] & last2byte);
                        currentByte = (char) (currentByte &lt;&lt; 4);
                        if (i + 1 &lt; from.length) {
                            currentByte = (char) (currentByte | (from[i + 1] & lead4byte) &gt;&gt;&gt; 4);
                        }
                }

                to.append(encodeTable[currentByte]);
            }
        }

        if (to.length() % 4 != 0) {
            for (i = 4 - to.length() % 4; i &gt; 0; --i) {
                to.append("=");
            }
        }

        return to.toString();
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="59" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.267</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> HttpUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-common\src\main\java\com\wanxin\common\util\HttpUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.common.util;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.List;
import java.util.Map;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class HttpUtil {

    public static String getAccessToken(String ak, String sk) throws Exception {
        // 获取token地址
        String authHost = "https://aip.baidubce.com/oauth/2.0/token?";
        String getAccessTokenUrl = authHost
                // 1.grant_type为固定参数
                + "grant_type=client_credentials"
                // 2.官网获取的 API Key
                + "&client_id=" + ak
                // 3.官网获取的 Secret Key
                + "&client_secret=" + sk;
        URL realUrl = new URL(getAccessTokenUrl);
        // 打开和URL之间的连接
        HttpURLConnection connection = (HttpURLConnection) realUrl.openConnection();
        connection.setRequestMethod("GET");
        connection.connect();
        // 获取所有响应头字段
            /*Map&lt;String, List&lt;String&gt;&gt; map = connection.getHeaderFields();
            // 遍历所有的响应头字段
            for (String key : map.keySet()) {
                System.err.println(key + "---&gt;" + map.get(key));
            }*/
        // 定义 BufferedReader输入流来读取URL的响应
        BufferedReader in = new BufferedReader(new InputStreamReader(connection.getInputStream()));
        String result = "";
        String line;
        while ((line = in.readLine()) != null) {
            result += line;
        }
        in.close();
        connection.disconnect();
        /**
         * 返回结果
         */
        Map&lt;String, Object&gt; resultMap = JsonUtil.jsonToMap(result);
        return resultMap.get("access_token").toString();
    }

    public static String post(String requestUrl, String accessToken, String params)
            throws Exception {
        String contentType = "application/x-www-form-urlencoded";
        return HttpUtil.post(requestUrl, accessToken, contentType, params);
    }

    public static String post(String requestUrl, String accessToken, String contentType, String params)
            throws Exception {
        String encoding = "UTF-8";
        if (requestUrl.contains("nlp")) {
            encoding = "GBK";
        }
        return HttpUtil.post(requestUrl, accessToken, contentType, params, encoding);
    }

    public static String post(String requestUrl, String accessToken, String contentType, String params, String encoding)
            throws Exception {
        String url = requestUrl + "?access_token=" + accessToken;
        return HttpUtil.postGeneralUrl(url, contentType, params, encoding);
    }

    public static String postGeneralUrl(String generalUrl, String contentType, String params, String encoding)
            throws Exception {
        URL url = new URL(generalUrl);
        // 打开和URL之间的连接
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("POST");
        // 设置通用的请求属性
        connection.setRequestProperty("Content-Type", contentType);
        connection.setRequestProperty("Connection", "Keep-Alive");
        connection.setUseCaches(false);
        connection.setDoOutput(true);
        connection.setDoInput(true);
        connection.setConnectTimeout(20000);
        connection.setReadTimeout(20000);

        // 得到请求的输出流对象
        DataOutputStream out = new DataOutputStream(connection.getOutputStream());
        out.write(params.getBytes(encoding));
        out.flush();
        out.close();

        // 建立实际的连接
        connection.connect();
        // 获取所有响应头字段
        Map&lt;String, List&lt;String&gt;&gt; headers = connection.getHeaderFields();
        // 遍历所有的响应头字段
        /*for (String key : headers.keySet()) {
            System.err.println(key + "---&gt;" + headers.get(key));
        }*/
        // 定义 BufferedReader输入流来读取URL的响应
        BufferedReader in = null;
        in = new BufferedReader(
                new InputStreamReader(connection.getInputStream(), encoding));
        String result = "";
        String getLine;
        while ((getLine = in.readLine()) != null) {
            result += getLine;
        }
        in.close();
        connection.disconnect();
        // System.err.println("result:" + result);
        return result;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="60" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.269</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> SecurityUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\common\SecurityUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.common;

import com.alibaba.fastjson.JSONObject;
import com.wanxin.api.account.model.LoginUser;
import com.wanxin.common.util.EncryptUtil;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.servlet.http.HttpServletRequest;
import java.util.Map;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class SecurityUtil {

    /**
     * 获取当前登录用户
     */
    public static LoginUser getUser() {
        ServletRequestAttributes servletRequestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        LoginUser loginUser = new LoginUser();
        if (servletRequestAttributes != null) {
            HttpServletRequest request = servletRequestAttributes.getRequest();

            Map jwt = JSONObject.parseObject(EncryptUtil.decodeBase64(request.getHeader("jsonToken")), Map.class);
            if (jwt.get("mobile").toString() != null && !"".equals(jwt.get("mobile").toString())) {
                loginUser.setMobile(jwt.get("mobile").toString());
            }

            if (jwt.get("client_id").toString() != null && !"".equals(jwt.get("client_id").toString())) {
                loginUser.setClientId(jwt.get("client_id").toString());
            }
        }

        return loginUser;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="61" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.272</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> Base64Util.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\utils\Base64Util.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.utils;

/**
 * Base64 工具类
 *
 * @author yuelimin
 * @since 1.8
 */
public class Base64Util {
    private static final char last2byte = (char) Integer.parseInt("00000011", 2);
    private static final char last4byte = (char) Integer.parseInt("00001111", 2);
    private static final char last6byte = (char) Integer.parseInt("00111111", 2);
    private static final char lead6byte = (char) Integer.parseInt("11111100", 2);
    private static final char lead4byte = (char) Integer.parseInt("11110000", 2);
    private static final char lead2byte = (char) Integer.parseInt("11000000", 2);
    private static final char[] encodeTable = new char[]{'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/'};

    public Base64Util() {
    }

    public static String encode(byte[] from) {
        StringBuilder to = new StringBuilder((int) ((double) from.length * 1.34D) + 3);
        int num = 0;
        char currentByte = 0;

        int i;
        for (i = 0; i &lt; from.length; ++i) {
            for (num %= 8; num &lt; 8; num += 6) {
                switch (num) {
                    case 0:
                        currentByte = (char) (from[i] & lead6byte);
                        currentByte = (char) (currentByte &gt;&gt;&gt; 2);
                    case 1:
                    case 3:
                    case 5:
                    default:
                        break;
                    case 2:
                        currentByte = (char) (from[i] & last6byte);
                        break;
                    case 4:
                        currentByte = (char) (from[i] & last4byte);
                        currentByte = (char) (currentByte &lt;&lt; 2);
                        if (i + 1 &lt; from.length) {
                            currentByte = (char) (currentByte | (from[i + 1] & lead2byte) &gt;&gt;&gt; 6);
                        }
                        break;
                    case 6:
                        currentByte = (char) (from[i] & last2byte);
                        currentByte = (char) (currentByte &lt;&lt; 4);
                        if (i + 1 &lt; from.length) {
                            currentByte = (char) (currentByte | (from[i + 1] & lead4byte) &gt;&gt;&gt; 4);
                        }
                }

                to.append(encodeTable[currentByte]);
            }
        }

        if (to.length() % 4 != 0) {
            for (i = 4 - to.length() % 4; i &gt; 0; --i) {
                to.append("=");
            }
        }

        return to.toString();
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="62" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.273</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> HttpUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\utils\HttpUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.utils;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

/**
 * http 工具类
 *
 * @author yuelimin
 * @since 1.8
 */
public class HttpUtil {

    public static String post(String requestUrl, String accessToken, String params)
            throws Exception {
        String contentType = "application/x-www-form-urlencoded";
        return HttpUtil.post(requestUrl, accessToken, contentType, params);
    }

    public static String post(String requestUrl, String accessToken, String contentType, String params)
            throws Exception {
        String encoding = "UTF-8";
        if (requestUrl.contains("nlp")) {
            encoding = "GBK";
        }
        return HttpUtil.post(requestUrl, accessToken, contentType, params, encoding);
    }

    public static String post(String requestUrl, String accessToken, String contentType, String params, String encoding)
            throws Exception {
        String url = requestUrl + "?access_token=" + accessToken;
        return HttpUtil.postGeneralUrl(url, contentType, params, encoding);
    }

    public static String postGeneralUrl(String generalUrl, String contentType, String params, String encoding)
            throws Exception {
        URL url = new URL(generalUrl);
        // 打开和URL之间的连接
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("POST");
        // 设置通用的请求属性
        connection.setRequestProperty("Content-Type", contentType);
        connection.setRequestProperty("Connection", "Keep-Alive");
        connection.setUseCaches(false);
        connection.setDoOutput(true);
        connection.setDoInput(true);

        // 得到请求的输出流对象
        DataOutputStream out = new DataOutputStream(connection.getOutputStream());
        out.write(params.getBytes(encoding));
        out.flush();
        out.close();

        // 建立实际的连接
        connection.connect();
        // 定义 BufferedReader输入流来读取URL的响应
        BufferedReader in = null;
        in = new BufferedReader(
                new InputStreamReader(connection.getInputStream(), encoding));
        String result = "";
        String getLine;
        while ((getLine = in.readLine()) != null) {
            result += getLine;
        }
        in.close();
        return result;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="63" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.276</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> ClientDefaultAccessTokenConverter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-gateway-server\src\main\java\com\wanxin\gateway\config\ClientDefaultAccessTokenConverter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.gateway.config;

import com.alibaba.fastjson.JSON;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.AuthorityUtils;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.provider.OAuth2Authentication;
import org.springframework.security.oauth2.provider.OAuth2Request;
import org.springframework.security.oauth2.provider.token.AccessTokenConverter;
import org.springframework.security.oauth2.provider.token.DefaultUserAuthenticationConverter;
import org.springframework.security.oauth2.provider.token.UserAuthenticationConverter;

import java.util.*;

/**
 * 令牌格式json与spring OAuth2Authentication的转换
 * 增加jwt对client Authorities的支持
 *
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class ClientDefaultAccessTokenConverter implements AccessTokenConverter {

    public static final String CLIENT_AUTHORITIES = "client_authorities";
    private UserAuthenticationConverter userTokenConverter = new DefaultUserAuthenticationConverter();
    private boolean includeGrantType;

    /**
     * Converter for the part of the data in the token representing a user.
     *
     * @param userTokenConverter the userTokenConverter to set
     */
    public void setUserTokenConverter(UserAuthenticationConverter userTokenConverter) {
        this.userTokenConverter = userTokenConverter;
    }

    /**
     * Flag to indicate the the grant type should be included in the converted token.
     *
     * @param includeGrantType the flag value (default false)
     */
    public void setIncludeGrantType(boolean includeGrantType) {
        this.includeGrantType = includeGrantType;
    }

    @Override
    public Map&lt;String, ?&gt; convertAccessToken(OAuth2AccessToken token, OAuth2Authentication authentication) {
        Map&lt;String, Object&gt; response = new HashMap&lt;String, Object&gt;();
        OAuth2Request clientToken = authentication.getOAuth2Request();

        if (!authentication.isClientOnly()) {
            response.putAll(userTokenConverter.convertUserAuthentication(authentication.getUserAuthentication()));

            ///增加对client Authorities支持
            if (authentication.getOAuth2Request().getAuthorities() != null && !authentication.getOAuth2Request().getAuthorities().isEmpty()) {
                response.put(CLIENT_AUTHORITIES,
                        AuthorityUtils.authorityListToSet(authentication.getOAuth2Request().getAuthorities()));
            }
            ///结束增加对client Authorities支持
        } else {
            if (clientToken.getAuthorities() != null && !clientToken.getAuthorities().isEmpty()) {
                response.put(UserAuthenticationConverter.AUTHORITIES,
                        AuthorityUtils.authorityListToSet(clientToken.getAuthorities()));
            }
        }

        if (token.getScope() != null) {
            response.put(SCOPE, token.getScope());
        }
        if (token.getAdditionalInformation().containsKey(JTI)) {
            response.put(JTI, token.getAdditionalInformation().get(JTI));
        }

        if (token.getExpiration() != null) {
            response.put(EXP, token.getExpiration().getTime() / 1000);
        }

        if (includeGrantType && authentication.getOAuth2Request().getGrantType() != null) {
            response.put(GRANT_TYPE, authentication.getOAuth2Request().getGrantType());
        }

        response.putAll(token.getAdditionalInformation());

        response.put(CLIENT_ID, clientToken.getClientId());
        if (clientToken.getResourceIds() != null && !clientToken.getResourceIds().isEmpty()) {
            response.put(AUD, clientToken.getResourceIds());
        }

        return response;
    }

    @Override
    public OAuth2AccessToken extractAccessToken(String value, Map&lt;String, ?&gt; map) {
        DefaultOAuth2AccessToken token = new DefaultOAuth2AccessToken(value);
        Map&lt;String, Object&gt; info = new HashMap&lt;String, Object&gt;(map);
        info.remove(EXP);
        info.remove(AUD);
        info.remove(CLIENT_ID);
        info.remove(SCOPE);
        if (map.containsKey(EXP)) {
            token.setExpiration(new Date((Long) map.get(EXP) * 1000L));
        }
        if (map.containsKey(JTI)) {
            info.put(JTI, map.get(JTI));
        }
        token.setScope(extractScope(map));
        token.setAdditionalInformation(info);
        return token;
    }

    @Override
    public OAuth2Authentication extractAuthentication(Map&lt;String, ?&gt; map) {
        Map&lt;String, String&gt; parameters = new HashMap&lt;String, String&gt;();
        Set&lt;String&gt; scope = extractScope(map);
        Authentication user = userTokenConverter.extractAuthentication(map);
        String clientId = (String) map.get(CLIENT_ID);
        parameters.put(CLIENT_ID, clientId);
        if (includeGrantType && map.containsKey(GRANT_TYPE)) {
            parameters.put(GRANT_TYPE, (String) map.get(GRANT_TYPE));
        }
        Set&lt;String&gt; resourceIds = new LinkedHashSet&lt;String&gt;(map.containsKey(AUD) ? getAudience(map)
                : Collections.&lt;String&gt;emptySet());

        Collection&lt;? extends GrantedAuthority&gt; authorities = null;
        if (user == null && map.containsKey(AUTHORITIES)) {
            @SuppressWarnings("unchecked")
            String[] roles = ((Collection&lt;String&gt;) map.get(AUTHORITIES)).toArray(new String[0]);
            authorities = AuthorityUtils.createAuthorityList(roles);
        }
        // 增加对client Authorities支持
        if (user != null && map.containsKey(CLIENT_AUTHORITIES)) {
            String[] clentRoles = ((Collection&lt;String&gt;) map.get(CLIENT_AUTHORITIES)).toArray(new String[0]);
            authorities = AuthorityUtils.createAuthorityList(clentRoles);
            // 增加额外属性
            parameters.put("mobile", (String) map.get("mobile"));
            parameters.put("tenant_id", (String) map.get("tenant_id"));
            parameters.put("department_id", (String) map.get("department_id"));
            parameters.put("user_authorities", JSON.toJSONString(map.get("user_authorities")));
            parameters.put("payload", JSON.toJSONString(map.get("payload")));
            // 结束增加额外属性
        }
        // 结束增加对client Authorities支持

        OAuth2Request request = new OAuth2Request(parameters, clientId, authorities, true, scope, resourceIds, null, null,
                null);
        return new OAuth2Authentication(request, user);
    }

    private Collection&lt;String&gt; getAudience(Map&lt;String, ?&gt; map) {
        Object auds = map.get(AUD);
        if (auds instanceof Collection) {
            @SuppressWarnings("unchecked")
            Collection&lt;String&gt; result = (Collection&lt;String&gt;) auds;
            return result;
        }
        return Collections.singleton((String) auds);
    }

    private Set&lt;String&gt; extractScope(Map&lt;String, ?&gt; map) {
        Set&lt;String&gt; scope = Collections.emptySet();
        if (map.containsKey(SCOPE)) {
            Object scopeObj = map.get(SCOPE);
            if (String.class.isInstance(scopeObj)) {
                scope = new LinkedHashSet&lt;String&gt;(Arrays.asList(String.class.cast(scopeObj).split(" ")));
            } else if (Collection.class.isAssignableFrom(scopeObj.getClass())) {
                @SuppressWarnings("unchecked")
                Collection&lt;String&gt; scopeColl = (Collection&lt;String&gt;) scopeObj;
                // Preserve ordering
                scope = new LinkedHashSet&lt;String&gt;(scopeColl);
            }
        }
        return scope;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="64" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.279</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> SecurityUtil.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Utility File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-transaction-service\src\main\java\com\wanxin\transaction\common\utils\SecurityUtil.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.transaction.common.utils;

import com.alibaba.fastjson.JSONObject;
import com.wanxin.api.account.model.LoginUser;
import com.wanxin.common.util.EncryptUtil;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.servlet.http.HttpServletRequest;
import java.util.Map;

/**
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class SecurityUtil {

    /**
     * 获取当前登录用户
     */
    public static LoginUser getUser() {
        ServletRequestAttributes servletRequestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        LoginUser loginUser = new LoginUser();
        if (servletRequestAttributes != null) {
            HttpServletRequest request = servletRequestAttributes.getRequest();

            Map jwt = JSONObject.parseObject(EncryptUtil.decodeBase64(request.getHeader("jsonToken")), Map.class);
            if (jwt.get("mobile").toString() != null && !"".equals(jwt.get("mobile").toString())) {
                loginUser.setMobile(jwt.get("mobile").toString());
            }

            if (jwt.get("client_id").toString() != null && !"".equals(jwt.get("client_id").toString())) {
                loginUser.setClientId(jwt.get("client_id").toString());
            }
        }

        return loginUser;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div>
                            <div id="divpager-3"></div>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class="layui-card" id="65" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.210</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> HeaderGenerator.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>order-service\src\main\java\com\rainbowforest\orderservice\http\header\HeaderGenerator.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.rainbowforest.orderservice.http.header;

import java.net.URI;
import java.net.URISyntaxException;
import javax.servlet.http.HttpServletRequest;
import org.springframework.http.HttpHeaders;
import org.springframework.stereotype.Service;

@Service
public class HeaderGenerator {

	public HttpHeaders getHeadersForSuccessGetMethod() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForError() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/problem+json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForSuccessPostMethod(HttpServletRequest request, Long newResourceId) {
		HttpHeaders httpHeaders = new HttpHeaders();
		try {
			httpHeaders.setLocation(new URI(request.getRequestURI() + "/" + newResourceId));
		} catch (URISyntaxException e) {
			e.printStackTrace();
		}
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="66" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.212</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> HeaderGenerator.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>product-catalog-service\src\main\java\com\rainbowforest\productcatalogservice\http\header\HeaderGenerator.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.rainbowforest.productcatalogservice.http.header;

import java.net.URI;
import java.net.URISyntaxException;

import javax.servlet.http.HttpServletRequest;

import org.springframework.http.HttpHeaders;
import org.springframework.stereotype.Service;

@Service
public class HeaderGenerator {

	public HttpHeaders getHeadersForSuccessGetMethod() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForError() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/problem+json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForSuccessPostMethod(HttpServletRequest request, Long newResourceId) {
		HttpHeaders httpHeaders = new HttpHeaders();
		try {
			httpHeaders.setLocation(new URI(request.getRequestURI() + "/" + newResourceId));
		} catch (URISyntaxException e) {
			e.printStackTrace();
		}
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="67" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.214</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> HeaderGenerator.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>product-recommendation-service\src\main\java\com\rainbowforest\recommendationservice\http\header\HeaderGenerator.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.rainbowforest.recommendationservice.http.header;

import java.net.URI;
import java.net.URISyntaxException;

import javax.servlet.http.HttpServletRequest;

import org.springframework.http.HttpHeaders;
import org.springframework.stereotype.Service;

@Service
public class HeaderGenerator {

	public HttpHeaders getHeadersForSuccessGetMethod() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForError() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/problem+json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForSuccessPostMethod(HttpServletRequest request, Long newResourceId) {
		HttpHeaders httpHeaders = new HttpHeaders();
		try {
			httpHeaders.setLocation(new URI(request.getRequestURI() + "/" + newResourceId));
		} catch (URISyntaxException e) {
			e.printStackTrace();
		}
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="68" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.216</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> e-commerce</a><br />
                                    <b> <a> File: </a> </b>  <a> HeaderGenerator.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>user-service\src\main\java\com\rainbowforest\userservice\http\header\HeaderGenerator.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.rainbowforest.userservice.http.header;

import java.net.URI;
import java.net.URISyntaxException;
import javax.servlet.http.HttpServletRequest;
import org.springframework.http.HttpHeaders;
import org.springframework.stereotype.Service;

@Service
public class HeaderGenerator {

	public HttpHeaders getHeadersForSuccessGetMethod() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForError() {
		HttpHeaders httpHeaders = new HttpHeaders();
		httpHeaders.add("Content-Type", "application/problem+json; charset=UTF-8");
		return httpHeaders;
	}

	public HttpHeaders getHeadersForSuccessPostMethod(HttpServletRequest request, Long newResourceId) {
		HttpHeaders httpHeaders = new HttpHeaders();
		try {
			httpHeaders.setLocation(new URI(request.getRequestURI() + "/" + newResourceId));
		} catch (URISyntaxException e) {
			e.printStackTrace();
		}
		httpHeaders.add("Content-Type", "application/json; charset=UTF-8");
		return httpHeaders;
	}
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="69" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.218</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> swarm</a><br />
                                    <b> <a> File: </a> </b>  <a> FlagValidatorClass.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>mall-demo\src\main\java\com\macro\mall\demo\validator\FlagValidatorClass.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.macro.mall.demo.validator;

import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;

/**
 * 状态标记校验器
 */
public class FlagValidatorClass implements ConstraintValidator&lt;FlagValidator,Integer&gt; {
    private String[] values;
    @Override
    public void initialize(FlagValidator flagValidator) {
        this.values = flagValidator.value();
    }

    @Override
    public boolean isValid(Integer value, ConstraintValidatorContext constraintValidatorContext) {
        boolean isValid = false;
        for(int i=0;i&lt;values.length;i++){
            if(values[i].equals(String.valueOf(value))){
                isValid = true;
                break;
            }
        }
        return isValid;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="70" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.235</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> NetworkDisk</a><br />
                                    <b> <a> File: </a> </b>  <a> PreFilter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pan-core-service\pan-core-zuul\src\main\java\top\quhailong\pan\core\zuul\filter\PreFilter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package top.quhailong.pan.core.zuul.filter;

import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import io.jsonwebtoken.Claims;
import org.apache.commons.codec.binary.Base64;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;
import top.quhailong.pan.response.UserInfoDTO;
import top.quhailong.pan.utils.CookieUtils;
import top.quhailong.pan.utils.JSONUtils;
import top.quhailong.pan.utils.JWTUtils;

import javax.servlet.http.HttpServletRequest;

/**
 * token过滤器，校验token必输项方法，token不能为空
 *
 * @author guooo
 */
@Component
public class PreFilter extends ZuulFilter {

    private static Logger log = LoggerFactory.getLogger(PreFilter.class);

    /*
     * 过滤器的具体逻辑。可用很复杂，包括查sql，nosql去判断该请求到底有没有权限访问。
     *
     * @see com.netflix.zuul.IZuulFilter#run()
     */
    private String getBase64Credentials(String username, String password) {
        String plainCreds = username + ":" + password;
        byte[] plainCredsBytes = plainCreds.getBytes();
        byte[] base64CredsBytes = Base64.encodeBase64(plainCredsBytes);
        return new String(base64CredsBytes);
    }
    @Override
    public Object run() {
        RequestContext ctx = RequestContext.getCurrentContext();
        ctx.addZuulRequestHeader("Authorization","Basic " + getBase64Credentials("admin","admin123"));
        HttpServletRequest request = ctx.getRequest();
        String curOrigin = request.getHeader("Origin");
        log.info(String.format("%s &gt;&gt;&gt; %s &gt;&gt;&gt; %s", request.getMethod(), request.getRequestURI(), curOrigin));
        if (request.getRequestURI().contains("/api/user")) {
            if (request.getRequestURI().contains("logout") || request.getRequestURI().contains("changepwd") || request.getRequestURI().contains("loadimg") || request.getRequestURI().contains("uploadpic")) {
                verifyToken(ctx);
            }
        }
        if(request.getRequestURI().contains("/api/core")){
            verifyToken(ctx);
        }

        //---------------------------------------------------------------------------------------------------------------------------------------
            /*if (request.getRequestURI().contains("/regcheckusername") || request.getRequestURI().contains("/regcheckphone") || request.getRequestURI().contains("/getpass") || request.getRequestURI().contains("/css") || request.getRequestURI().contains("/js") || request.getRequestURI().contains("/css") || request.getRequestURI().contains("/images")) {
                ctx.setSendZuulResponse(true);
                return null;
            }
            InputStream in = (InputStream) ctx.get("requestEntity");
            if (in == null) {
                in = ctx.getRequest().getInputStream();
            }
            String token = null;
            if (request.getRequestURI().equals("/api/edge/getpublickey")) {
                ctx.setSendZuulResponse(true);
                return null;
            }
            if (!request.getRequestURI().contains("getverfyimg") && !request.getRequestURI().contains("regsmscodestr")) {
                if (!request.getContentType().contains("multipart/form-data")) {
                    token = ctx.getRequest().getParameter("token");
                } else {
                    Part part = request.getPart("token");
                    InputStream name = part.getInputStream();
                    token = StreamUtils.copyToString(name, Charset.forName("UTF-8"));
                }
            }
            if (request.getRequestURI().equals("/api/user/logout") || request.getRequestURI().equals("/api/user/changepwd") || request.getRequestURI().equals("/api/user/uploadpic") || request.getRequestURI().equals("/api/user/loadimg")) {
                Claims claims = JWTUtils.parseJWT(token, "nimadetou".getBytes());
                String subject = claims.getSubject();
                Userinfo userinfo = JsonUtils.jsonToPojo(subject, Userinfo.class);
                log.info(userinfo.getUid());
                ctx.setSendZuulResponse(true);
                return null;
            } else {
                ctx.setSendZuulResponse(true);
                return null;
            }*/
        return null;
    }

    private void verifyToken(RequestContext ctx) {
        try {
            String token = CookieUtils.getCookie("token");
            Claims claims = JWTUtils.parseJWT(token, "nimadetou".getBytes());
            String subject = claims.getSubject();
            UserInfoDTO userinfo = JSONUtils.parseObject(subject, UserInfoDTO.class);
            log.info(userinfo.getUserId());
            ctx.setSendZuulResponse(true);
        } catch (Exception e) {
            ctx.setSendZuulResponse(false);
        }
    }

    /*
     * 这里可以写逻辑判断，是否要过滤，本文true,永远过滤。
     *
     * @see com.netflix.zuul.IZuulFilter#shouldFilter()
     */
    @Override
    public boolean shouldFilter() {
        return true;
    }

    @Override
    public int filterOrder() {
        return 0;
    }

    /*
     * (non-Javadoc) pre：路由之前 routing：路由之时 post： 路由之后 error：发送错误调用
     *
     * @see com.netflix.zuul.ZuulFilter#filterType()
     */
    @Override
    public String filterType() {
        return "pre";
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="71" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.237</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> NetworkDisk</a><br />
                                    <b> <a> File: </a> </b>  <a> PreFilter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>pan-file-service\pan-file-zuul\src\main\java\top\quhailong\pan\file\zuul\filter\PreFilter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package top.quhailong.pan.file.zuul.filter;

import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import io.jsonwebtoken.Claims;
import org.apache.commons.codec.binary.Base64;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;
import top.quhailong.pan.response.UserInfoDTO;
import top.quhailong.pan.utils.CookieUtils;
import top.quhailong.pan.utils.JSONUtils;
import top.quhailong.pan.utils.JWTUtils;

import javax.servlet.http.HttpServletRequest;

/**
 * token过滤器，校验token必输项方法，token不能为空
 *
 * @author guooo
 */
@Component
public class PreFilter extends ZuulFilter {

    private static Logger log = LoggerFactory.getLogger(PreFilter.class);

    /*
     * 过滤器的具体逻辑。可用很复杂，包括查sql，nosql去判断该请求到底有没有权限访问。
     *
     * @see com.netflix.zuul.IZuulFilter#run()
     */
    private String getBase64Credentials(String username, String password) {
        String plainCreds = username + ":" + password;
        byte[] plainCredsBytes = plainCreds.getBytes();
        byte[] base64CredsBytes = Base64.encodeBase64(plainCredsBytes);
        return new String(base64CredsBytes);
    }

    @Override
    public Object run() {
        RequestContext ctx = RequestContext.getCurrentContext();
        try {
            HttpServletRequest request = ctx.getRequest();
            ctx.addZuulRequestHeader("Authorization", "Basic " + getBase64Credentials("admin", "admin123"));
            String curOrigin = request.getHeader("Origin");
            log.info(String.format("%s &gt;&gt;&gt; %s &gt;&gt;&gt; %s", request.getMethod(), request.getRequestURI().toString(), curOrigin));
            if (request.getRequestURI().contains("/api/file")) {
                verifyToken(ctx);
            }
            /*String token = ctx.getRequest().getParameter("token");
            InputStream in = (InputStream) ctx.get("requestEntity");
            if (in == null) {
                in = ctx.getRequest().getInputStream();
            }
            if (!StringUtils.isEmpty(token)) {
                Claims claims = JWTUtils.parseJWT(token, "nimadetou".getBytes());
                String subject = claims.getSubject();
                Userinfo userinfo = JSONUtils.parseObject(subject, Userinfo.class);
                String body = StreamUtils.copyToString(in, Charset.forName("UTF-8"));
                body = StringUtils.replace(body, "token=" + token, "uid=" + userinfo.getUid());
                final byte[] reqBodyBytes = body.getBytes();
                ctx.setRequest(new HttpServletRequestWrapper(request) {
                    @Override
                    public ServletInputStream getInputStream() throws IOException {
                        return new ServletInputStreamWrapper(reqBodyBytes);
                    }

                    @Override
                    public int getContentLength() {
                        return reqBodyBytes.length;
                    }

                    @Override
                    public long getContentLengthLong() {
                        return reqBodyBytes.length;
                    }
                });
                ctx.setSendZuulResponse(true);
                return null;
            } else {
                ctx.setSendZuulResponse(false);
                return null;
            }*/
            return null;
        } catch (Exception e) {
            ctx.setSendZuulResponse(false);
            return null;
        }

    }

    private void verifyToken(RequestContext ctx) {
        try {
            String token = CookieUtils.getCookie("token");
            Claims claims = JWTUtils.parseJWT(token, "nimadetou".getBytes());
            String subject = claims.getSubject();
            UserInfoDTO userinfo = JSONUtils.parseObject(subject, UserInfoDTO.class);
            log.info(userinfo.getUserId());
            ctx.setSendZuulResponse(true);
        } catch (Exception e) {
            ctx.setSendZuulResponse(false);
        }
    }

    /*
     * 这里可以写逻辑判断，是否要过滤，本文true,永远过滤。
     *
     * @see com.netflix.zuul.IZuulFilter#shouldFilter()
     */
    @Override
    public boolean shouldFilter() {
        return true;
    }

    @Override
    public int filterOrder() {
        return 0;
    }

    /*
     * (non-Javadoc) pre：路由之前 routing：路由之时 post： 路由之后 error：发送错误调用
     *
     * @see com.netflix.zuul.ZuulFilter#filterType()
     */
    @Override
    public String filterType() {
        return "pre";
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="72" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.243</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> sns</a><br />
                                    <b> <a> File: </a> </b>  <a> JwtInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>sns-article\src\main\java\com\zrkworld\sns\article\interceptor\JwtInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zrkworld.sns.article.interceptor;

import io.jsonwebtoken.Claims;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import utils.JwtUtil;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * 拦截器,用来jwt鉴权
 * @author zrk
 */
@Component
public class JwtInterceptor implements HandlerInterceptor {
    @Resource
    private JwtUtil jwtUtil;

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 无论如何都放行，具体能不能操作还是在具体操作中去判断
        // 拦截器只负责把请求头中包含token的令牌进行解析
        String header = request.getHeader("Authorization");
        if (!StringUtils.isEmpty(header)) {
            // 如果有包含Authorization的头信息，就对其进行解析
            if (header.startsWith("Bearer ")) {
                // 得到token
                final String token = header.substring(7);
                // 对令牌进行验证
                try {
                    Claims claims = jwtUtil.parseJWT(token);
                    String roles = (String) claims.get("role");
                    if ("admin".equals(roles)) {
                        request.setAttribute("claims_admin", token);
                    }
                    if ("user".equals(roles)) {
                        request.setAttribute("claims_user", token);
                    }
                } catch (Exception e) {
                    throw new RuntimeException("令牌有误!");
                }
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="73" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.244</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> sns</a><br />
                                    <b> <a> File: </a> </b>  <a> JwtInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>sns-friend\src\main\java\com\zrkworld\sns\friend\interceptor\JwtInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zrkworld.sns.friend.interceptor;

import io.jsonwebtoken.Claims;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import utils.JwtUtil;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@Component
public class JwtInterceptor implements HandlerInterceptor {
    @Resource
    private JwtUtil jwtUtil;

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 无论如何都放行，具体能不能操作还是在具体操作中去判断
        // 拦截器只负责把请求头中包含token的令牌进行解析
        String header = request.getHeader("Authorization");
        if (!StringUtils.isEmpty(header)) {
            // 如果有包含Authorization的头信息，就对其进行解析
            if (header.startsWith("Bearer ")) {
                // 得到token
                final String token = header.substring(7);
                // 对令牌进行验证
                try {
                    Claims claims = jwtUtil.parseJWT(token);
                    String roles = (String) claims.get("role");
                    if ("admin".equals(roles)) {
                        request.setAttribute("claims_admin", claims);
                    }
                    if ("user".equals(roles)) {
                        request.setAttribute("claims_user", claims);
                    }
                } catch (Exception e) {
                    throw new RuntimeException("令牌有误!");
                }
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="74" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.245</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> sns</a><br />
                                    <b> <a> File: </a> </b>  <a> JwtInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>sns-qa\src\main\java\com.zrkworld.sns.qa\interceptor\JwtInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zrkworld.sns.qa.interceptor;

import io.jsonwebtoken.Claims;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import utils.JwtUtil;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@Component
public class JwtInterceptor implements HandlerInterceptor {
    @Resource
    private JwtUtil jwtUtil;

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 无论如何都放行，具体能不能操作还是在具体操作中去判断
        // 拦截器只负责把请求头中包含token的令牌进行解析
        String header = request.getHeader("Authorization");
        if (!StringUtils.isEmpty(header)) {
            // 如果有包含Authorization的头信息，就对其进行解析
            if (header.startsWith("Bearer ")) {
                // 得到token
                final String token = header.substring(7);
                // 对令牌进行验证
                try {
                    Claims claims = jwtUtil.parseJWT(token);
                    String roles = (String) claims.get("roles");
                    if ("admin".equals(roles)) {
                        request.setAttribute("claims_admin", token);
                    }
                    if ("user".equals(roles)) {
                        request.setAttribute("claims_user", token);
                    }
                } catch (Exception e) {
                    throw new RuntimeException("令牌有误!");
                }
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="75" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.246</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> sns</a><br />
                                    <b> <a> File: </a> </b>  <a> JwtInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>sns-spit\src\main\java\com\zrkworld\sns\spit\interceptor\JwtInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zrkworld.sns.spit.interceptor;

import io.jsonwebtoken.Claims;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import utils.JwtUtil;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@Component
public class JwtInterceptor implements HandlerInterceptor {
    @Resource
    private JwtUtil jwtUtil;

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 无论如何都放行，具体能不能操作还是在具体操作中去判断
        // 拦截器只负责把请求头中包含token的令牌进行解析
        String header = request.getHeader("Authorization");
        if (!StringUtils.isEmpty(header)) {
            // 如果有包含Authorization的头信息，就对其进行解析
            if (header.startsWith("Bearer ")) {
                // 得到token
                final String token = header.substring(7);
                // 对令牌进行验证
                try {
                    Claims claims = jwtUtil.parseJWT(token);
                    String roles = (String) claims.get("role");
                    if ("admin".equals(roles)) {
                        request.setAttribute("claims_admin", token);
                    }
                    if ("user".equals(roles)) {
                        request.setAttribute("claims_user", token);
                    }
                } catch (Exception e) {
                    throw new RuntimeException("令牌有误!");
                }
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="76" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.247</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> sns</a><br />
                                    <b> <a> File: </a> </b>  <a> JwtInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>sns-user\src\main\java\com\zrkworld\sns\user\interceptor\JwtInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zrkworld.sns.user.interceptor;

import io.jsonwebtoken.Claims;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import utils.JwtUtil;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@Component
public class JwtInterceptor implements HandlerInterceptor {
    @Resource
    private JwtUtil jwtUtil;

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 无论如何都放行，具体能不能操作还是在具体操作中去判断
        // 拦截器只负责把请求头中包含token的令牌进行解析
        String header = request.getHeader("Authorization");
        if (!StringUtils.isEmpty(header)) {
            // 如果有包含Authorization的头信息，就对其进行解析
            if (header.startsWith("Bearer ")) {
                // 得到token
                final String token = header.substring(7);
                // 对令牌进行验证
                try {
                    Claims claims = jwtUtil.parseJWT(token);
                    String roles = (String) claims.get("role");
                    if ("admin".equals(roles)) {
                        request.setAttribute("claims_admin", token);
                    }
                    if ("user".equals(roles)) {
                        request.setAttribute("claims_user", token);
                    }
                } catch (Exception e) {
                    throw new RuntimeException("令牌有误!");
                }
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="77" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.248</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> HTMLFilter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-admin\src\main\java\io\renren\common\xss\HTMLFilter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package io.renren.common.xss;

import java.util.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;
import java.util.logging.Logger;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 *
 * HTML filtering utility for protecting against XSS (Cross Site Scripting).
 *
 * This code is licensed LGPLv3
 *
 * This code is a Java port of the original work in PHP by Cal Hendersen.
 * http://code.iamcal.com/php/lib_filter/
 *
 * The trickiest part of the translation was handling the differences in regex handling
 * between PHP and Java.  These resources were helpful in the process:
 *
 * http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html
 * http://us2.php.net/manual/en/reference.pcre.pattern.modifiers.php
 * http://www.regular-expressions.info/modifiers.html
 *
 * A note on naming conventions: instance variables are prefixed with a "v"; global
 * constants are in all caps.
 *
 * Sample use:
 * String input = ...
 * String clean = new HTMLFilter().filter( input );
 *
 * The class is not thread safe. Create a new instance if in doubt.
 *
 * If you find bugs or have suggestions on improvement (especially regarding
 * performance), please contact us.  The latest version of this
 * source, and our contact details, can be found at http://xss-html-filter.sf.net
 *
 * @author Joseph O'Connell
 * @author Cal Hendersen
 * @author Michael Semb Wever
 */
public final class HTMLFilter {

    /** regex flag union representing /si modifiers in php **/
    private static final int REGEX_FLAGS_SI = Pattern.CASE_INSENSITIVE | Pattern.DOTALL;
    private static final Pattern P_COMMENTS = Pattern.compile("&lt;!--(.*?)--&gt;", Pattern.DOTALL);
    private static final Pattern P_COMMENT = Pattern.compile("^!--(.*)--$", REGEX_FLAGS_SI);
    private static final Pattern P_TAGS = Pattern.compile("&lt;(.*?)&gt;", Pattern.DOTALL);
    private static final Pattern P_END_TAG = Pattern.compile("^/([a-z0-9]+)", REGEX_FLAGS_SI);
    private static final Pattern P_START_TAG = Pattern.compile("^([a-z0-9]+)(.*?)(/?)$", REGEX_FLAGS_SI);
    private static final Pattern P_QUOTED_ATTRIBUTES = Pattern.compile("([a-z0-9]+)=([\"'])(.*?)\\2", REGEX_FLAGS_SI);
    private static final Pattern P_UNQUOTED_ATTRIBUTES = Pattern.compile("([a-z0-9]+)(=)([^\"\\s']+)", REGEX_FLAGS_SI);
    private static final Pattern P_PROTOCOL = Pattern.compile("^([^:]+):", REGEX_FLAGS_SI);
    private static final Pattern P_ENTITY = Pattern.compile("&#(\\d+);?");
    private static final Pattern P_ENTITY_UNICODE = Pattern.compile("&#x([0-9a-f]+);?");
    private static final Pattern P_ENCODE = Pattern.compile("%([0-9a-f]{2});?");
    private static final Pattern P_VALID_ENTITIES = Pattern.compile("&([^&;]*)(?=(;|&|$))");
    private static final Pattern P_VALID_QUOTES = Pattern.compile("(&gt;|^)([^&lt;]+?)(&lt;|$)", Pattern.DOTALL);
    private static final Pattern P_END_ARROW = Pattern.compile("^&gt;");
    private static final Pattern P_BODY_TO_END = Pattern.compile("&lt;([^&gt;]*?)(?=&lt;|$)");
    private static final Pattern P_XML_CONTENT = Pattern.compile("(^|&gt;)([^&lt;]*?)(?=&gt;)");
    private static final Pattern P_STRAY_LEFT_ARROW = Pattern.compile("&lt;([^&gt;]*?)(?=&lt;|$)");
    private static final Pattern P_STRAY_RIGHT_ARROW = Pattern.compile("(^|&gt;)([^&lt;]*?)(?=&gt;)");
    private static final Pattern P_AMP = Pattern.compile("&");
    private static final Pattern P_QUOTE = Pattern.compile("&lt;");
    private static final Pattern P_LEFT_ARROW = Pattern.compile("&lt;");
    private static final Pattern P_RIGHT_ARROW = Pattern.compile("&gt;");
    private static final Pattern P_BOTH_ARROWS = Pattern.compile("&lt;&gt;");

    // @xxx could grow large... maybe use sesat's ReferenceMap
    private static final ConcurrentMap&lt;String,Pattern&gt; P_REMOVE_PAIR_BLANKS = new ConcurrentHashMap&lt;String, Pattern&gt;();
    private static final ConcurrentMap&lt;String,Pattern&gt; P_REMOVE_SELF_BLANKS = new ConcurrentHashMap&lt;String, Pattern&gt;();

    /** set of allowed html elements, along with allowed attributes for each element **/
    private final Map&lt;String, List&lt;String&gt;&gt; vAllowed;
    /** counts of open tags for each (allowable) html element **/
    private final Map&lt;String, Integer&gt; vTagCounts = new HashMap&lt;String, Integer&gt;();

    /** html elements which must always be self-closing (e.g. "&lt;img /&gt;") **/
    private final String[] vSelfClosingTags;
    /** html elements which must always have separate opening and closing tags (e.g. "&lt;b&gt;&lt;/b&gt;") **/
    private final String[] vNeedClosingTags;
    /** set of disallowed html elements **/
    private final String[] vDisallowed;
    /** attributes which should be checked for valid protocols **/
    private final String[] vProtocolAtts;
    /** allowed protocols **/
    private final String[] vAllowedProtocols;
    /** tags which should be removed if they contain no content (e.g. "&lt;b&gt;&lt;/b&gt;" or "&lt;b /&gt;") **/
    private final String[] vRemoveBlanks;
    /** entities allowed within html markup **/
    private final String[] vAllowedEntities;
    /** flag determining whether comments are allowed in input String. */
    private final boolean stripComment;
    private final boolean encodeQuotes;
    private boolean vDebug = false;
    /**
     * flag determining whether to try to make tags when presented with "unbalanced"
     * angle brackets (e.g. "&lt;b text &lt;/b&gt;" becomes "&lt;b&gt; text &lt;/b&gt;").  If set to false,
     * unbalanced angle brackets will be html escaped.
     */
    private final boolean alwaysMakeTags;

    /** Default constructor.
     *
     */
    public HTMLFilter() {
        vAllowed = new HashMap&lt;&gt;();

        final ArrayList&lt;String&gt; a_atts = new ArrayList&lt;String&gt;();
        a_atts.add("href");
        a_atts.add("target");
        vAllowed.put("a", a_atts);

        final ArrayList&lt;String&gt; img_atts = new ArrayList&lt;String&gt;();
        img_atts.add("src");
        img_atts.add("width");
        img_atts.add("height");
        img_atts.add("alt");
        vAllowed.put("img", img_atts);

        final ArrayList&lt;String&gt; no_atts = new ArrayList&lt;String&gt;();
        vAllowed.put("b", no_atts);
        vAllowed.put("strong", no_atts);
        vAllowed.put("i", no_atts);
        vAllowed.put("em", no_atts);

        vSelfClosingTags = new String[]{"img"};
        vNeedClosingTags = new String[]{"a", "b", "strong", "i", "em"};
        vDisallowed = new String[]{};
        vAllowedProtocols = new String[]{"http", "mailto", "https"}; // no ftp.
        vProtocolAtts = new String[]{"src", "href"};
        vRemoveBlanks = new String[]{"a", "b", "strong", "i", "em"};
        vAllowedEntities = new String[]{"amp", "gt", "lt", "quot"};
        stripComment = true;
        encodeQuotes = true;
        alwaysMakeTags = true;
    }

    /** Set debug flag to true. Otherwise use default settings. See the default constructor.
     *
     * @param debug turn debug on with a true argument
     */
    public HTMLFilter(final boolean debug) {
        this();
        vDebug = debug;

    }

    /** Map-parameter configurable constructor.
     *
     * @param conf map containing configuration. keys match field names.
     */
    public HTMLFilter(final Map&lt;String,Object&gt; conf) {

        assert conf.containsKey("vAllowed") : "configuration requires vAllowed";
        assert conf.containsKey("vSelfClosingTags") : "configuration requires vSelfClosingTags";
        assert conf.containsKey("vNeedClosingTags") : "configuration requires vNeedClosingTags";
        assert conf.containsKey("vDisallowed") : "configuration requires vDisallowed";
        assert conf.containsKey("vAllowedProtocols") : "configuration requires vAllowedProtocols";
        assert conf.containsKey("vProtocolAtts") : "configuration requires vProtocolAtts";
        assert conf.containsKey("vRemoveBlanks") : "configuration requires vRemoveBlanks";
        assert conf.containsKey("vAllowedEntities") : "configuration requires vAllowedEntities";

        vAllowed = Collections.unmodifiableMap((HashMap&lt;String, List&lt;String&gt;&gt;) conf.get("vAllowed"));
        vSelfClosingTags = (String[]) conf.get("vSelfClosingTags");
        vNeedClosingTags = (String[]) conf.get("vNeedClosingTags");
        vDisallowed = (String[]) conf.get("vDisallowed");
        vAllowedProtocols = (String[]) conf.get("vAllowedProtocols");
        vProtocolAtts = (String[]) conf.get("vProtocolAtts");
        vRemoveBlanks = (String[]) conf.get("vRemoveBlanks");
        vAllowedEntities = (String[]) conf.get("vAllowedEntities");
        stripComment =  conf.containsKey("stripComment") ? (Boolean) conf.get("stripComment") : true;
        encodeQuotes = conf.containsKey("encodeQuotes") ? (Boolean) conf.get("encodeQuotes") : true;
        alwaysMakeTags = conf.containsKey("alwaysMakeTags") ? (Boolean) conf.get("alwaysMakeTags") : true;
    }

    private void reset() {
        vTagCounts.clear();
    }

    private void debug(final String msg) {
        if (vDebug) {
            Logger.getAnonymousLogger().info(msg);
        }
    }

    //---------------------------------------------------------------
    // my versions of some PHP library functions
    public static String chr(final int decimal) {
        return String.valueOf((char) decimal);
    }

    public static String htmlSpecialChars(final String s) {
        String result = s;
        result = regexReplace(P_AMP, "&amp;", result);
        result = regexReplace(P_QUOTE, "&quot;", result);
        result = regexReplace(P_LEFT_ARROW, "&lt;", result);
        result = regexReplace(P_RIGHT_ARROW, "&gt;", result);
        return result;
    }

    //---------------------------------------------------------------
    /**
     * given a user submitted input String, filter out any invalid or restricted
     * html.
     *
     * @param input text (i.e. submitted by a user) than may contain html
     * @return "clean" version of input, with only valid, whitelisted html elements allowed
     */
    public String filter(final String input) {
        reset();
        String s = input;

        debug("************************************************");
        debug("              INPUT: " + input);

        s = escapeComments(s);
        debug("     escapeComments: " + s);

        s = balanceHTML(s);
        debug("        balanceHTML: " + s);

        s = checkTags(s);
        debug("          checkTags: " + s);

        s = processRemoveBlanks(s);
        debug("processRemoveBlanks: " + s);

        s = validateEntities(s);
        debug("    validateEntites: " + s);

        debug("************************************************\n\n");
        return s;
    }

    public boolean isAlwaysMakeTags(){
        return alwaysMakeTags;
    }

    public boolean isStripComments(){
        return stripComment;
    }

    private String escapeComments(final String s) {
        final Matcher m = P_COMMENTS.matcher(s);
        final StringBuffer buf = new StringBuffer();
        if (m.find()) {
            final String match = m.group(1); //(.*?)
            m.appendReplacement(buf, Matcher.quoteReplacement("&lt;!--" + htmlSpecialChars(match) + "--&gt;"));
        }
        m.appendTail(buf);

        return buf.toString();
    }

    private String balanceHTML(String s) {
        if (alwaysMakeTags) {
            //
            // try and form html
            //
            s = regexReplace(P_END_ARROW, "", s);
            s = regexReplace(P_BODY_TO_END, "&lt;$1&gt;", s);
            s = regexReplace(P_XML_CONTENT, "$1&lt;$2", s);

        } else {
            //
            // escape stray brackets
            //
            s = regexReplace(P_STRAY_LEFT_ARROW, "&lt;$1", s);
            s = regexReplace(P_STRAY_RIGHT_ARROW, "$1$2&gt;&lt;", s);

            //
            // the last regexp causes '&lt;&gt;' entities to appear
            // (we need to do a lookahead assertion so that the last bracket can
            // be used in the next pass of the regexp)
            //
            s = regexReplace(P_BOTH_ARROWS, "", s);
        }

        return s;
    }

    private String checkTags(String s) {
        Matcher m = P_TAGS.matcher(s);

        final StringBuffer buf = new StringBuffer();
        while (m.find()) {
            String replaceStr = m.group(1);
            replaceStr = processTag(replaceStr);
            m.appendReplacement(buf, Matcher.quoteReplacement(replaceStr));
        }
        m.appendTail(buf);

        s = buf.toString();

        // these get tallied in processTag
        // (remember to reset before subsequent calls to filter method)
        for (String key : vTagCounts.keySet()) {
            for (int ii = 0; ii &lt; vTagCounts.get(key); ii++) {
                s += "&lt;/" + key + "&gt;";
            }
        }

        return s;
    }

    private String processRemoveBlanks(final String s) {
        String result = s;
        for (String tag : vRemoveBlanks) {
            if(!P_REMOVE_PAIR_BLANKS.containsKey(tag)){
                P_REMOVE_PAIR_BLANKS.putIfAbsent(tag, Pattern.compile("&lt;" + tag + "(\\s[^&gt;]*)?&gt;&lt;/" + tag + "&gt;"));
            }
            result = regexReplace(P_REMOVE_PAIR_BLANKS.get(tag), "", result);
            if(!P_REMOVE_SELF_BLANKS.containsKey(tag)){
                P_REMOVE_SELF_BLANKS.putIfAbsent(tag, Pattern.compile("&lt;" + tag + "(\\s[^&gt;]*)?/&gt;"));
            }
            result = regexReplace(P_REMOVE_SELF_BLANKS.get(tag), "", result);
        }

        return result;
    }

    private static String regexReplace(final Pattern regex_pattern, final String replacement, final String s) {
        Matcher m = regex_pattern.matcher(s);
        return m.replaceAll(replacement);
    }

    private String processTag(final String s) {
        // ending tags
        Matcher m = P_END_TAG.matcher(s);
        if (m.find()) {
            final String name = m.group(1).toLowerCase();
            if (allowed(name)) {
                if (!inArray(name, vSelfClosingTags)) {
                    if (vTagCounts.containsKey(name)) {
                        vTagCounts.put(name, vTagCounts.get(name) - 1);
                        return "&lt;/" + name + "&gt;";
                    }
                }
            }
        }

        // starting tags
        m = P_START_TAG.matcher(s);
        if (m.find()) {
            final String name = m.group(1).toLowerCase();
            final String body = m.group(2);
            String ending = m.group(3);

            //debug( "in a starting tag, name='" + name + "'; body='" + body + "'; ending='" + ending + "'" );
            if (allowed(name)) {
                String params = "";

                final Matcher m2 = P_QUOTED_ATTRIBUTES.matcher(body);
                final Matcher m3 = P_UNQUOTED_ATTRIBUTES.matcher(body);
                final List&lt;String&gt; paramNames = new ArrayList&lt;String&gt;();
                final List&lt;String&gt; paramValues = new ArrayList&lt;String&gt;();
                while (m2.find()) {
                    paramNames.add(m2.group(1)); //([a-z0-9]+)
                    paramValues.add(m2.group(3)); //(.*?)
                }
                while (m3.find()) {
                    paramNames.add(m3.group(1)); //([a-z0-9]+)
                    paramValues.add(m3.group(3)); //([^\"\\s']+)
                }

                String paramName, paramValue;
                for (int ii = 0; ii &lt; paramNames.size(); ii++) {
                    paramName = paramNames.get(ii).toLowerCase();
                    paramValue = paramValues.get(ii);

//          debug( "paramName='" + paramName + "'" );
//          debug( "paramValue='" + paramValue + "'" );
//          debug( "allowed? " + vAllowed.get( name ).contains( paramName ) );

                    if (allowedAttribute(name, paramName)) {
                        if (inArray(paramName, vProtocolAtts)) {
                            paramValue = processParamProtocol(paramValue);
                        }
                        params += " " + paramName + "=\"" + paramValue + "\"";
                    }
                }

                if (inArray(name, vSelfClosingTags)) {
                    ending = " /";
                }

                if (inArray(name, vNeedClosingTags)) {
                    ending = "";
                }

                if (ending == null || ending.length() &lt; 1) {
                    if (vTagCounts.containsKey(name)) {
                        vTagCounts.put(name, vTagCounts.get(name) + 1);
                    } else {
                        vTagCounts.put(name, 1);
                    }
                } else {
                    ending = " /";
                }
                return "&lt;" + name + params + ending + "&gt;";
            } else {
                return "";
            }
        }

        // comments
        m = P_COMMENT.matcher(s);
        if (!stripComment && m.find()) {
            return  "&lt;" + m.group() + "&gt;";
        }

        return "";
    }

    private String processParamProtocol(String s) {
        s = decodeEntities(s);
        final Matcher m = P_PROTOCOL.matcher(s);
        if (m.find()) {
            final String protocol = m.group(1);
            if (!inArray(protocol, vAllowedProtocols)) {
                // bad protocol, turn into local anchor link instead
                s = "#" + s.substring(protocol.length() + 1, s.length());
                if (s.startsWith("#//")) {
                    s = "#" + s.substring(3, s.length());
                }
            }
        }

        return s;
    }

    private String decodeEntities(String s) {
        StringBuffer buf = new StringBuffer();

        Matcher m = P_ENTITY.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.decode(match).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        buf = new StringBuffer();
        m = P_ENTITY_UNICODE.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.valueOf(match, 16).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        buf = new StringBuffer();
        m = P_ENCODE.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.valueOf(match, 16).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        s = validateEntities(s);
        return s;
    }

    private String validateEntities(final String s) {
        StringBuffer buf = new StringBuffer();

        // validate entities throughout the string
        Matcher m = P_VALID_ENTITIES.matcher(s);
        while (m.find()) {
            final String one = m.group(1); //([^&;]*)
            final String two = m.group(2); //(?=(;|&|$))
            m.appendReplacement(buf, Matcher.quoteReplacement(checkEntity(one, two)));
        }
        m.appendTail(buf);

        return encodeQuotes(buf.toString());
    }

    private String encodeQuotes(final String s){
        if(encodeQuotes){
            StringBuffer buf = new StringBuffer();
            Matcher m = P_VALID_QUOTES.matcher(s);
            while (m.find()) {
                final String one = m.group(1); //(&gt;|^)
                final String two = m.group(2); //([^&lt;]+?)
                final String three = m.group(3); //(&lt;|$)
                m.appendReplacement(buf, Matcher.quoteReplacement(one + regexReplace(P_QUOTE, "&quot;", two) + three));
            }
            m.appendTail(buf);
            return buf.toString();
        }else{
            return s;
        }
    }

    private String checkEntity(final String preamble, final String term) {

        return ";".equals(term) && isValidEntity(preamble)
                ? '&' + preamble
                : "&amp;" + preamble;
    }

    private boolean isValidEntity(final String entity) {
        return inArray(entity, vAllowedEntities);
    }

    private static boolean inArray(final String s, final String[] array) {
        for (String item : array) {
            if (item != null && item.equals(s)) {
                return true;
            }
        }
        return false;
    }

    private boolean allowed(final String name) {
        return (vAllowed.isEmpty() || vAllowed.containsKey(name)) && !inArray(name, vDisallowed);
    }

    private boolean allowedAttribute(final String name, final String paramName) {
        return allowed(name) && (vAllowed.isEmpty() || vAllowed.get(name).contains(paramName));
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="78" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.250</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> HTMLFilter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-common\src\main\java\com\jerusalem\common\xss\HTMLFilter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.common.xss;

import java.util.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;
import java.util.logging.Logger;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 *
 * HTML filtering utility for protecting against XSS (Cross Site Scripting).
 *
 * This code is licensed LGPLv3
 *
 * This code is a Java port of the original work in PHP by Cal Hendersen.
 * http://code.iamcal.com/php/lib_filter/
 *
 * The trickiest part of the translation was handling the differences in regex handling
 * between PHP and Java.  These resources were helpful in the process:
 *
 * http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html
 * http://us2.php.net/manual/en/reference.pcre.pattern.modifiers.php
 * http://www.regular-expressions.info/modifiers.html
 *
 * A note on naming conventions: instance variables are prefixed with a "v"; global
 * constants are in all caps.
 *
 * Sample use:
 * String input = ...
 * String clean = new HTMLFilter().filter( input );
 *
 * The class is not thread safe. Create a new instance if in doubt.
 *
 * If you find bugs or have suggestions on improvement (especially regarding
 * performance), please contact us.  The latest version of this
 * source, and our contact details, can be found at http://xss-html-filter.sf.net
 *
 * @author Joseph O'Connell
 * @author Cal Hendersen
 * @author Michael Semb Wever
 */
public final class HTMLFilter {

    /** regex flag union representing /si modifiers in php **/
    private static final int REGEX_FLAGS_SI = Pattern.CASE_INSENSITIVE | Pattern.DOTALL;
    private static final Pattern P_COMMENTS = Pattern.compile("&lt;!--(.*?)--&gt;", Pattern.DOTALL);
    private static final Pattern P_COMMENT = Pattern.compile("^!--(.*)--$", REGEX_FLAGS_SI);
    private static final Pattern P_TAGS = Pattern.compile("&lt;(.*?)&gt;", Pattern.DOTALL);
    private static final Pattern P_END_TAG = Pattern.compile("^/([a-z0-9]+)", REGEX_FLAGS_SI);
    private static final Pattern P_START_TAG = Pattern.compile("^([a-z0-9]+)(.*?)(/?)$", REGEX_FLAGS_SI);
    private static final Pattern P_QUOTED_ATTRIBUTES = Pattern.compile("([a-z0-9]+)=([\"'])(.*?)\\2", REGEX_FLAGS_SI);
    private static final Pattern P_UNQUOTED_ATTRIBUTES = Pattern.compile("([a-z0-9]+)(=)([^\"\\s']+)", REGEX_FLAGS_SI);
    private static final Pattern P_PROTOCOL = Pattern.compile("^([^:]+):", REGEX_FLAGS_SI);
    private static final Pattern P_ENTITY = Pattern.compile("&#(\\d+);?");
    private static final Pattern P_ENTITY_UNICODE = Pattern.compile("&#x([0-9a-f]+);?");
    private static final Pattern P_ENCODE = Pattern.compile("%([0-9a-f]{2});?");
    private static final Pattern P_VALID_ENTITIES = Pattern.compile("&([^&;]*)(?=(;|&|$))");
    private static final Pattern P_VALID_QUOTES = Pattern.compile("(&gt;|^)([^&lt;]+?)(&lt;|$)", Pattern.DOTALL);
    private static final Pattern P_END_ARROW = Pattern.compile("^&gt;");
    private static final Pattern P_BODY_TO_END = Pattern.compile("&lt;([^&gt;]*?)(?=&lt;|$)");
    private static final Pattern P_XML_CONTENT = Pattern.compile("(^|&gt;)([^&lt;]*?)(?=&gt;)");
    private static final Pattern P_STRAY_LEFT_ARROW = Pattern.compile("&lt;([^&gt;]*?)(?=&lt;|$)");
    private static final Pattern P_STRAY_RIGHT_ARROW = Pattern.compile("(^|&gt;)([^&lt;]*?)(?=&gt;)");
    private static final Pattern P_AMP = Pattern.compile("&");
    private static final Pattern P_QUOTE = Pattern.compile("&lt;");
    private static final Pattern P_LEFT_ARROW = Pattern.compile("&lt;");
    private static final Pattern P_RIGHT_ARROW = Pattern.compile("&gt;");
    private static final Pattern P_BOTH_ARROWS = Pattern.compile("&lt;&gt;");

    // @xxx could grow large... maybe use sesat's ReferenceMap
    private static final ConcurrentMap&lt;String,Pattern&gt; P_REMOVE_PAIR_BLANKS = new ConcurrentHashMap&lt;String, Pattern&gt;();
    private static final ConcurrentMap&lt;String,Pattern&gt; P_REMOVE_SELF_BLANKS = new ConcurrentHashMap&lt;String, Pattern&gt;();

    /** set of allowed html elements, along with allowed attributes for each element **/
    private final Map&lt;String, List&lt;String&gt;&gt; vAllowed;
    /** counts of open tags for each (allowable) html element **/
    private final Map&lt;String, Integer&gt; vTagCounts = new HashMap&lt;String, Integer&gt;();

    /** html elements which must always be self-closing (e.g. "&lt;img /&gt;") **/
    private final String[] vSelfClosingTags;
    /** html elements which must always have separate opening and closing tags (e.g. "&lt;b&gt;&lt;/b&gt;") **/
    private final String[] vNeedClosingTags;
    /** set of disallowed html elements **/
    private final String[] vDisallowed;
    /** attributes which should be checked for valid protocols **/
    private final String[] vProtocolAtts;
    /** allowed protocols **/
    private final String[] vAllowedProtocols;
    /** tags which should be removed if they contain no content (e.g. "&lt;b&gt;&lt;/b&gt;" or "&lt;b /&gt;") **/
    private final String[] vRemoveBlanks;
    /** entities allowed within html markup **/
    private final String[] vAllowedEntities;
    /** flag determining whether comments are allowed in input String. */
    private final boolean stripComment;
    private final boolean encodeQuotes;
    private boolean vDebug = false;
    /**
     * flag determining whether to try to make tags when presented with "unbalanced"
     * angle brackets (e.g. "&lt;b text &lt;/b&gt;" becomes "&lt;b&gt; text &lt;/b&gt;").  If set to false,
     * unbalanced angle brackets will be html escaped.
     */
    private final boolean alwaysMakeTags;

    /** Default constructor.
     *
     */
    public HTMLFilter() {
        vAllowed = new HashMap&lt;&gt;();

        final ArrayList&lt;String&gt; a_atts = new ArrayList&lt;String&gt;();
        a_atts.add("href");
        a_atts.add("target");
        vAllowed.put("a", a_atts);

        final ArrayList&lt;String&gt; img_atts = new ArrayList&lt;String&gt;();
        img_atts.add("src");
        img_atts.add("width");
        img_atts.add("height");
        img_atts.add("alt");
        vAllowed.put("img", img_atts);

        final ArrayList&lt;String&gt; no_atts = new ArrayList&lt;String&gt;();
        vAllowed.put("b", no_atts);
        vAllowed.put("strong", no_atts);
        vAllowed.put("i", no_atts);
        vAllowed.put("em", no_atts);

        vSelfClosingTags = new String[]{"img"};
        vNeedClosingTags = new String[]{"a", "b", "strong", "i", "em"};
        vDisallowed = new String[]{};
        vAllowedProtocols = new String[]{"http", "mailto", "https"}; // no ftp.
        vProtocolAtts = new String[]{"src", "href"};
        vRemoveBlanks = new String[]{"a", "b", "strong", "i", "em"};
        vAllowedEntities = new String[]{"amp", "gt", "lt", "quot"};
        stripComment = true;
        encodeQuotes = true;
        alwaysMakeTags = true;
    }

    /** Set debug flag to true. Otherwise use default settings. See the default constructor.
     *
     * @param debug turn debug on with a true argument
     */
    public HTMLFilter(final boolean debug) {
        this();
        vDebug = debug;

    }

    /** Map-parameter configurable constructor.
     *
     * @param conf map containing configuration. keys match field names.
     */
    public HTMLFilter(final Map&lt;String,Object&gt; conf) {

        assert conf.containsKey("vAllowed") : "configuration requires vAllowed";
        assert conf.containsKey("vSelfClosingTags") : "configuration requires vSelfClosingTags";
        assert conf.containsKey("vNeedClosingTags") : "configuration requires vNeedClosingTags";
        assert conf.containsKey("vDisallowed") : "configuration requires vDisallowed";
        assert conf.containsKey("vAllowedProtocols") : "configuration requires vAllowedProtocols";
        assert conf.containsKey("vProtocolAtts") : "configuration requires vProtocolAtts";
        assert conf.containsKey("vRemoveBlanks") : "configuration requires vRemoveBlanks";
        assert conf.containsKey("vAllowedEntities") : "configuration requires vAllowedEntities";

        vAllowed = Collections.unmodifiableMap((HashMap&lt;String, List&lt;String&gt;&gt;) conf.get("vAllowed"));
        vSelfClosingTags = (String[]) conf.get("vSelfClosingTags");
        vNeedClosingTags = (String[]) conf.get("vNeedClosingTags");
        vDisallowed = (String[]) conf.get("vDisallowed");
        vAllowedProtocols = (String[]) conf.get("vAllowedProtocols");
        vProtocolAtts = (String[]) conf.get("vProtocolAtts");
        vRemoveBlanks = (String[]) conf.get("vRemoveBlanks");
        vAllowedEntities = (String[]) conf.get("vAllowedEntities");
        stripComment =  conf.containsKey("stripComment") ? (Boolean) conf.get("stripComment") : true;
        encodeQuotes = conf.containsKey("encodeQuotes") ? (Boolean) conf.get("encodeQuotes") : true;
        alwaysMakeTags = conf.containsKey("alwaysMakeTags") ? (Boolean) conf.get("alwaysMakeTags") : true;
    }

    private void reset() {
        vTagCounts.clear();
    }

    private void debug(final String msg) {
        if (vDebug) {
            Logger.getAnonymousLogger().info(msg);
        }
    }

    //---------------------------------------------------------------
    // my versions of some PHP library functions
    public static String chr(final int decimal) {
        return String.valueOf((char) decimal);
    }

    public static String htmlSpecialChars(final String s) {
        String result = s;
        result = regexReplace(P_AMP, "&amp;", result);
        result = regexReplace(P_QUOTE, "&quot;", result);
        result = regexReplace(P_LEFT_ARROW, "&lt;", result);
        result = regexReplace(P_RIGHT_ARROW, "&gt;", result);
        return result;
    }

    //---------------------------------------------------------------
    /**
     * given a user submitted input String, filter out any invalid or restricted
     * html.
     *
     * @param input text (i.e. submitted by a user) than may contain html
     * @return "clean" version of input, with only valid, whitelisted html elements allowed
     */
    public String filter(final String input) {
        reset();
        String s = input;

        debug("************************************************");
        debug("              INPUT: " + input);

        s = escapeComments(s);
        debug("     escapeComments: " + s);

        s = balanceHTML(s);
        debug("        balanceHTML: " + s);

        s = checkTags(s);
        debug("          checkTags: " + s);

        s = processRemoveBlanks(s);
        debug("processRemoveBlanks: " + s);

        s = validateEntities(s);
        debug("    validateEntites: " + s);

        debug("************************************************\n\n");
        return s;
    }

    public boolean isAlwaysMakeTags(){
        return alwaysMakeTags;
    }

    public boolean isStripComments(){
        return stripComment;
    }

    private String escapeComments(final String s) {
        final Matcher m = P_COMMENTS.matcher(s);
        final StringBuffer buf = new StringBuffer();
        if (m.find()) {
            final String match = m.group(1); //(.*?)
            m.appendReplacement(buf, Matcher.quoteReplacement("&lt;!--" + htmlSpecialChars(match) + "--&gt;"));
        }
        m.appendTail(buf);

        return buf.toString();
    }

    private String balanceHTML(String s) {
        if (alwaysMakeTags) {
            //
            // try and form html
            //
            s = regexReplace(P_END_ARROW, "", s);
            s = regexReplace(P_BODY_TO_END, "&lt;$1&gt;", s);
            s = regexReplace(P_XML_CONTENT, "$1&lt;$2", s);

        } else {
            //
            // escape stray brackets
            //
            s = regexReplace(P_STRAY_LEFT_ARROW, "&lt;$1", s);
            s = regexReplace(P_STRAY_RIGHT_ARROW, "$1$2&gt;&lt;", s);

            //
            // the last regexp causes '&lt;&gt;' entities to appear
            // (we need to do a lookahead assertion so that the last bracket can
            // be used in the next pass of the regexp)
            //
            s = regexReplace(P_BOTH_ARROWS, "", s);
        }

        return s;
    }

    private String checkTags(String s) {
        Matcher m = P_TAGS.matcher(s);

        final StringBuffer buf = new StringBuffer();
        while (m.find()) {
            String replaceStr = m.group(1);
            replaceStr = processTag(replaceStr);
            m.appendReplacement(buf, Matcher.quoteReplacement(replaceStr));
        }
        m.appendTail(buf);

        s = buf.toString();

        // these get tallied in processTag
        // (remember to reset before subsequent calls to filter method)
        for (String key : vTagCounts.keySet()) {
            for (int ii = 0; ii &lt; vTagCounts.get(key); ii++) {
                s += "&lt;/" + key + "&gt;";
            }
        }

        return s;
    }

    private String processRemoveBlanks(final String s) {
        String result = s;
        for (String tag : vRemoveBlanks) {
            if(!P_REMOVE_PAIR_BLANKS.containsKey(tag)){
                P_REMOVE_PAIR_BLANKS.putIfAbsent(tag, Pattern.compile("&lt;" + tag + "(\\s[^&gt;]*)?&gt;&lt;/" + tag + "&gt;"));
            }
            result = regexReplace(P_REMOVE_PAIR_BLANKS.get(tag), "", result);
            if(!P_REMOVE_SELF_BLANKS.containsKey(tag)){
                P_REMOVE_SELF_BLANKS.putIfAbsent(tag, Pattern.compile("&lt;" + tag + "(\\s[^&gt;]*)?/&gt;"));
            }
            result = regexReplace(P_REMOVE_SELF_BLANKS.get(tag), "", result);
        }

        return result;
    }

    private static String regexReplace(final Pattern regex_pattern, final String replacement, final String s) {
        Matcher m = regex_pattern.matcher(s);
        return m.replaceAll(replacement);
    }

    private String processTag(final String s) {
        // ending tags
        Matcher m = P_END_TAG.matcher(s);
        if (m.find()) {
            final String name = m.group(1).toLowerCase();
            if (allowed(name)) {
                if (!inArray(name, vSelfClosingTags)) {
                    if (vTagCounts.containsKey(name)) {
                        vTagCounts.put(name, vTagCounts.get(name) - 1);
                        return "&lt;/" + name + "&gt;";
                    }
                }
            }
        }

        // starting tags
        m = P_START_TAG.matcher(s);
        if (m.find()) {
            final String name = m.group(1).toLowerCase();
            final String body = m.group(2);
            String ending = m.group(3);

            //debug( "in a starting tag, name='" + name + "'; body='" + body + "'; ending='" + ending + "'" );
            if (allowed(name)) {
                String params = "";

                final Matcher m2 = P_QUOTED_ATTRIBUTES.matcher(body);
                final Matcher m3 = P_UNQUOTED_ATTRIBUTES.matcher(body);
                final List&lt;String&gt; paramNames = new ArrayList&lt;String&gt;();
                final List&lt;String&gt; paramValues = new ArrayList&lt;String&gt;();
                while (m2.find()) {
                    paramNames.add(m2.group(1)); //([a-z0-9]+)
                    paramValues.add(m2.group(3)); //(.*?)
                }
                while (m3.find()) {
                    paramNames.add(m3.group(1)); //([a-z0-9]+)
                    paramValues.add(m3.group(3)); //([^\"\\s']+)
                }

                String paramName, paramValue;
                for (int ii = 0; ii &lt; paramNames.size(); ii++) {
                    paramName = paramNames.get(ii).toLowerCase();
                    paramValue = paramValues.get(ii);

//          debug( "paramName='" + paramName + "'" );
//          debug( "paramValue='" + paramValue + "'" );
//          debug( "allowed? " + vAllowed.get( name ).contains( paramName ) );

                    if (allowedAttribute(name, paramName)) {
                        if (inArray(paramName, vProtocolAtts)) {
                            paramValue = processParamProtocol(paramValue);
                        }
                        params += " " + paramName + "=\"" + paramValue + "\"";
                    }
                }

                if (inArray(name, vSelfClosingTags)) {
                    ending = " /";
                }

                if (inArray(name, vNeedClosingTags)) {
                    ending = "";
                }

                if (ending == null || ending.length() &lt; 1) {
                    if (vTagCounts.containsKey(name)) {
                        vTagCounts.put(name, vTagCounts.get(name) + 1);
                    } else {
                        vTagCounts.put(name, 1);
                    }
                } else {
                    ending = " /";
                }
                return "&lt;" + name + params + ending + "&gt;";
            } else {
                return "";
            }
        }

        // comments
        m = P_COMMENT.matcher(s);
        if (!stripComment && m.find()) {
            return  "&lt;" + m.group() + "&gt;";
        }

        return "";
    }

    private String processParamProtocol(String s) {
        s = decodeEntities(s);
        final Matcher m = P_PROTOCOL.matcher(s);
        if (m.find()) {
            final String protocol = m.group(1);
            if (!inArray(protocol, vAllowedProtocols)) {
                // bad protocol, turn into local anchor link instead
                s = "#" + s.substring(protocol.length() + 1, s.length());
                if (s.startsWith("#//")) {
                    s = "#" + s.substring(3, s.length());
                }
            }
        }

        return s;
    }

    private String decodeEntities(String s) {
        StringBuffer buf = new StringBuffer();

        Matcher m = P_ENTITY.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.decode(match).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        buf = new StringBuffer();
        m = P_ENTITY_UNICODE.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.valueOf(match, 16).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        buf = new StringBuffer();
        m = P_ENCODE.matcher(s);
        while (m.find()) {
            final String match = m.group(1);
            final int decimal = Integer.valueOf(match, 16).intValue();
            m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));
        }
        m.appendTail(buf);
        s = buf.toString();

        s = validateEntities(s);
        return s;
    }

    private String validateEntities(final String s) {
        StringBuffer buf = new StringBuffer();

        // validate entities throughout the string
        Matcher m = P_VALID_ENTITIES.matcher(s);
        while (m.find()) {
            final String one = m.group(1); //([^&;]*)
            final String two = m.group(2); //(?=(;|&|$))
            m.appendReplacement(buf, Matcher.quoteReplacement(checkEntity(one, two)));
        }
        m.appendTail(buf);

        return encodeQuotes(buf.toString());
    }

    private String encodeQuotes(final String s){
        if(encodeQuotes){
            StringBuffer buf = new StringBuffer();
            Matcher m = P_VALID_QUOTES.matcher(s);
            while (m.find()) {
                final String one = m.group(1); //(&gt;|^)
                final String two = m.group(2); //([^&lt;]+?)
                final String three = m.group(3); //(&lt;|$)
                m.appendReplacement(buf, Matcher.quoteReplacement(one + regexReplace(P_QUOTE, "&quot;", two) + three));
            }
            m.appendTail(buf);
            return buf.toString();
        }else{
            return s;
        }
    }

    private String checkEntity(final String preamble, final String term) {

        return ";".equals(term) && isValidEntity(preamble)
                ? '&' + preamble
                : "&amp;" + preamble;
    }

    private boolean isValidEntity(final String entity) {
        return inArray(entity, vAllowedEntities);
    }

    private static boolean inArray(final String s, final String[] array) {
        for (String item : array) {
            if (item != null && item.equals(s)) {
                return true;
            }
        }
        return false;
    }

    private boolean allowed(final String name) {
        return (vAllowed.isEmpty() || vAllowed.containsKey(name)) && !inArray(name, vDisallowed);
    }

    private boolean allowedAttribute(final String name, final String paramName) {
        return allowed(name) && (vAllowed.isEmpty() || vAllowed.get(name).contains(paramName));
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="79" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.255</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> LoginInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-order\src\main\java\com\jerusalem\order\interceptor\LoginInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.order.interceptor;

import com.jerusalem.common.constant.AuthConstant;
import com.jerusalem.common.vo.UserResponseVo;
import org.springframework.stereotype.Component;
import org.springframework.util.AntPathMatcher;
import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/****
 * @Author: jerusalem
 * @Description: LoginInterceptor
 * 订单登录拦截器
 * @Date 2020/11/7 12:29
 *****/
@Component
public class LoginInterceptor implements HandlerInterceptor {

    /***
     * 全系统共享当前登录用户
     */
    public static ThreadLocal&lt;UserResponseVo&gt; loginUser = new ThreadLocal&lt;&gt;();

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        /***
         * 放行库存系统的个别请求
         */
        String uri = request.getRequestURI();
        AntPathMatcher antPathMatcher = new AntPathMatcher();
        boolean match = antPathMatcher.match("/order/orders/status/**", uri);
        //放行支付成功异步通知回调
        boolean match1 = antPathMatcher.match("/payed/notify", uri);
        if (match || match1){
            return true;
        }

        UserResponseVo userResponseVo = (UserResponseVo) request.getSession().getAttribute(AuthConstant.LOGIN_USER);
        if (userResponseVo != null){
            //全系统共享
            loginUser.set(userResponseVo);
            return true;
        }else {
            //没登陆，拦截,重定向到登录页面
            request.getSession().setAttribute("msg","请先登录！");
            response.sendRedirect("http://auth.tesco.com/login.html");
            return false;
        }
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="80" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.258</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> tesco-mall</a><br />
                                    <b> <a> File: </a> </b>  <a> LoginInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>tesco-seckill\src\main\java\com\jerusalem\seckill\interceptor\LoginInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.jerusalem.seckill.interceptor;

import com.jerusalem.common.constant.AuthConstant;
import com.jerusalem.common.vo.UserResponseVo;
import org.springframework.stereotype.Component;
import org.springframework.util.AntPathMatcher;
import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/****
 * @Author: jerusalem
 * @Description: LoginInterceptor
 * 秒杀登录拦截器
 * @Date 2020/11/7 12:29
 *****/
@Component
public class LoginInterceptor implements HandlerInterceptor {

    /***
     * 全系统共享当前登录用户
     */
    public static ThreadLocal&lt;UserResponseVo&gt; loginUser = new ThreadLocal&lt;&gt;();

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        /***
         * 拦截秒杀系统的个别请求，进行登陆检查
         * 其他的放行
         */
        String uri = request.getRequestURI();
        AntPathMatcher antPathMatcher = new AntPathMatcher();
        boolean match = antPathMatcher.match("/seckill/kill", uri);
        if (match){
            UserResponseVo userResponseVo = (UserResponseVo) request.getSession().getAttribute(AuthConstant.LOGIN_USER);
            if (userResponseVo != null){
                //全系统共享
                loginUser.set(userResponseVo);
                return true;
            }else {
                //没登陆，拦截,重定向到登录页面
                request.getSession().setAttribute("msg","请先登录！");
                response.sendRedirect("http://auth.tesco.com/login.html");
                return false;
            }
        }
        return true;
    }
}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="81" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.271</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> TokenInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-consumer-service\src\main\java\com\wanxin\consumer\interceptor\TokenInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.consumer.interceptor;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.TypeReference;
import com.wanxin.api.account.model.LoginUser;
import com.wanxin.common.util.EncryptUtil;
import org.apache.commons.lang3.StringUtils;
import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Token拦截处理
 *
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class TokenInterceptor implements HandlerInterceptor {
    @Override
    public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) {
        String jsonToken = httpServletRequest.getParameter("jsonToken");
        if (StringUtils.isNotBlank(jsonToken)) {
            LoginUser loginUser = JSON.parseObject(EncryptUtil.decodeUTF8StringBase64(jsonToken), new TypeReference&lt;LoginUser&gt;() {
            });
            httpServletRequest.setAttribute("jsonToken", loginUser);
        }
        return true;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="82" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.277</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> TokenInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-repayment-service\src\main\java\com\wanxin\repayment\interceptor\TokenInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.repayment.interceptor;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.TypeReference;
import com.wanxin.api.account.model.LoginUser;
import com.wanxin.common.util.EncryptUtil;
import org.apache.commons.lang3.StringUtils;
import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Token拦截处理
 *
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class TokenInterceptor implements HandlerInterceptor {
    @Override
    public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) {
        String jsonToken = httpServletRequest.getParameter("jsonToken");
        if (StringUtils.isNotBlank(jsonToken)) {
            LoginUser loginUser = JSON.parseObject(EncryptUtil.decodeUTF8StringBase64(jsonToken), new TypeReference&lt;LoginUser&gt;() {
            });
            httpServletRequest.setAttribute("jsonToken", loginUser);
        }

        return true;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="83" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.281</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> TokenInterceptor.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-transaction-service\src\main\java\com\wanxin\transaction\interceptor\TokenInterceptor.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.transaction.interceptor;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.TypeReference;
import com.wanxin.api.account.model.LoginUser;
import com.wanxin.common.util.EncryptUtil;
import org.apache.commons.lang.StringUtils;
import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * &lt;P&gt;
 * Token 拦截处理
 * &lt;/p&gt;
 *
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class TokenInterceptor implements HandlerInterceptor {
    @Override
    public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) {
        String jsonToken = httpServletRequest.getParameter("jsonToken");
        if (StringUtils.isNotBlank(jsonToken)) {
            LoginUser loginUser = JSON.parseObject(EncryptUtil.decodeUTF8StringBase64(jsonToken), new TypeReference&lt;LoginUser&gt;() {
            });
            httpServletRequest.setAttribute("jsonToken", loginUser);
        }
        return true;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="84" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.283</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> wanxin</a><br />
                                    <b> <a> File: </a> </b>  <a> ClientDefaultAccessTokenConverter.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>wanxinp2p-uaa-service\src\main\java\com\wanxin\uaa\domain\ClientDefaultAccessTokenConverter.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.wanxin.uaa.domain;

import com.alibaba.fastjson.JSON;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.AuthorityUtils;
import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.provider.OAuth2Authentication;
import org.springframework.security.oauth2.provider.OAuth2Request;
import org.springframework.security.oauth2.provider.token.AccessTokenConverter;
import org.springframework.security.oauth2.provider.token.DefaultUserAuthenticationConverter;
import org.springframework.security.oauth2.provider.token.UserAuthenticationConverter;

import java.util.*;

/**
 * 令牌格式json与spring OAuth2Authentication的转换, 增加jwt对client Authorities的支持
 *
 * @author yuelimin
 * @version 1.0.0
 * @since 1.8
 */
public class ClientDefaultAccessTokenConverter implements AccessTokenConverter {

    public static final String CLIENT_AUTHORITIES = "client_authorities";
    private UserAuthenticationConverter userTokenConverter = new DefaultUserAuthenticationConverter();
    private boolean includeGrantType;

    /**
     * Converter for the part of the data in the token representing a user.
     *
     * @param userTokenConverter the userTokenConverter to set
     */
    public void setUserTokenConverter(UserAuthenticationConverter userTokenConverter) {
        this.userTokenConverter = userTokenConverter;
    }

    /**
     * Flag to indicate the the grant type should be included in the converted token.
     *
     * @param includeGrantType the flag value (default false)
     */
    public void setIncludeGrantType(boolean includeGrantType) {
        this.includeGrantType = includeGrantType;
    }

    public Map&lt;String, ?&gt; convertAccessToken(OAuth2AccessToken token, OAuth2Authentication authentication) {
        Map&lt;String, Object&gt; response = new HashMap&lt;String, Object&gt;();
        OAuth2Request clientToken = authentication.getOAuth2Request();

        if (!authentication.isClientOnly()) {
            response.putAll(userTokenConverter.convertUserAuthentication(authentication.getUserAuthentication()));

            ///增加对client Authorities支持
            if (authentication.getOAuth2Request().getAuthorities() != null && !authentication.getOAuth2Request().getAuthorities().isEmpty()) {
                response.put(CLIENT_AUTHORITIES,
                        AuthorityUtils.authorityListToSet(authentication.getOAuth2Request().getAuthorities()));
            }
            ///结束增加对client Authorities支持
        } else {
            if (clientToken.getAuthorities() != null && !clientToken.getAuthorities().isEmpty()) {
                response.put(UserAuthenticationConverter.AUTHORITIES,
                        AuthorityUtils.authorityListToSet(clientToken.getAuthorities()));
            }
        }

        if (token.getScope() != null) {
            response.put(SCOPE, token.getScope());
        }
        if (token.getAdditionalInformation().containsKey(JTI)) {
            response.put(JTI, token.getAdditionalInformation().get(JTI));
        }

        if (token.getExpiration() != null) {
            response.put(EXP, token.getExpiration().getTime() / 1000);
        }

        if (includeGrantType && authentication.getOAuth2Request().getGrantType() != null) {
            response.put(GRANT_TYPE, authentication.getOAuth2Request().getGrantType());
        }

        response.putAll(token.getAdditionalInformation());

        response.put(CLIENT_ID, clientToken.getClientId());
        if (clientToken.getResourceIds() != null && !clientToken.getResourceIds().isEmpty()) {
            response.put(AUD, clientToken.getResourceIds());
        }

        return response;
    }

    public OAuth2AccessToken extractAccessToken(String value, Map&lt;String, ?&gt; map) {
        DefaultOAuth2AccessToken token = new DefaultOAuth2AccessToken(value);
        Map&lt;String, Object&gt; info = new HashMap&lt;String, Object&gt;(map);
        info.remove(EXP);
        info.remove(AUD);
        info.remove(CLIENT_ID);
        info.remove(SCOPE);
        if (map.containsKey(EXP)) {
            token.setExpiration(new Date((Long) map.get(EXP) * 1000L));
        }
        if (map.containsKey(JTI)) {
            info.put(JTI, map.get(JTI));
        }
        token.setScope(extractScope(map));
        token.setAdditionalInformation(info);
        return token;
    }

    public OAuth2Authentication extractAuthentication(Map&lt;String, ?&gt; map) {
        Map&lt;String, String&gt; parameters = new HashMap&lt;String, String&gt;();
        Set&lt;String&gt; scope = extractScope(map);
        Authentication user = userTokenConverter.extractAuthentication(map);
        String clientId = (String) map.get(CLIENT_ID);
        parameters.put(CLIENT_ID, clientId);
        if (includeGrantType && map.containsKey(GRANT_TYPE)) {
            parameters.put(GRANT_TYPE, (String) map.get(GRANT_TYPE));
        }
        Set&lt;String&gt; resourceIds = new LinkedHashSet&lt;String&gt;(map.containsKey(AUD) ? getAudience(map)
                : Collections.&lt;String&gt;emptySet());

        Collection&lt;? extends GrantedAuthority&gt; authorities = null;
        if (user == null && map.containsKey(AUTHORITIES)) {
            @SuppressWarnings("unchecked")
            String[] roles = ((Collection&lt;String&gt;) map.get(AUTHORITIES)).toArray(new String[0]);
            authorities = AuthorityUtils.createAuthorityList(roles);
        }
        ///增加对client Authorities支持
        if (user != null && map.containsKey(CLIENT_AUTHORITIES)) {
            String[] clentRoles = ((Collection&lt;String&gt;) map.get(CLIENT_AUTHORITIES)).toArray(new String[0]);
            authorities = AuthorityUtils.createAuthorityList(clentRoles);
            ///增加额外属性
            parameters.put("mobile", (String) map.get("mobile"));
            parameters.put("tenant_id", (String) map.get("tenant_id"));
            parameters.put("department_id", (String) map.get("department_id"));
            parameters.put("user_authorities", JSON.toJSONString(map.get("user_authorities")));
            parameters.put("payload", JSON.toJSONString(map.get("payload")));
            ///结束增加额外属性
        }
        ///结束增加对client Authorities支持


        OAuth2Request request = new OAuth2Request(parameters, clientId, authorities, true, scope, resourceIds, null, null,
                null);
        return new OAuth2Authentication(request, user);
    }

    private Collection&lt;String&gt; getAudience(Map&lt;String, ?&gt; map) {
        Object auds = map.get(AUD);
        if (auds instanceof Collection) {
            @SuppressWarnings("unchecked")
            Collection&lt;String&gt; result = (Collection&lt;String&gt;) auds;
            return result;
        }
        return Collections.singleton((String) auds);
    }

    private Set&lt;String&gt; extractScope(Map&lt;String, ?&gt; map) {
        Set&lt;String&gt; scope = Collections.emptySet();
        if (map.containsKey(SCOPE)) {
            Object scopeObj = map.get(SCOPE);
            if (String.class.isInstance(scopeObj)) {
                scope = new LinkedHashSet&lt;String&gt;(Arrays.asList(String.class.cast(scopeObj).split(" ")));
            } else if (Collection.class.isAssignableFrom(scopeObj.getClass())) {
                @SuppressWarnings("unchecked")
                Collection&lt;String&gt; scopeColl = (Collection&lt;String&gt;) scopeObj;
                scope = new LinkedHashSet&lt;String&gt;(scopeColl);    // Preserve ordering
            }
        }
        return scope;
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="85" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.291</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> zheng</a><br />
                                    <b> <a> File: </a> </b>  <a> DefaultMessageQueueListener.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>zheng-api\zheng-api-server\src\main\java\com\zheng\api\server\jms\DefaultMessageQueueListener.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zheng.api.server.jms;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

/**
 * MQ消费者
 * Created by shuzheng on 2017/2/19.
 */
public class DefaultMessageQueueListener implements MessageListener {

    private static final Logger LOGGER = LoggerFactory.getLogger(DefaultMessageQueueListener.class);

    @Autowired
    ThreadPoolTaskExecutor threadPoolTaskExecutor;

    @Override
    public void onMessage(final Message message) {
        // 使用线程池多线程处理
        threadPoolTaskExecutor.execute(new Runnable() {
            @Override
            public void run() {
                if (message instanceof TextMessage) {
                    TextMessage textMessage = (TextMessage) message;
                    try {
                        LOGGER.info("消费：{}", textMessage.getText());
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
            }
        });
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="86" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.292</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> zheng</a><br />
                                    <b> <a> File: </a> </b>  <a> DefaultMessageQueueListener.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>zheng-cms\zheng-cms-admin\src\main\java\com\zheng\cms\admin\jms\DefaultMessageQueueListener.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zheng.cms.admin.jms;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

/**
 * MQ消费者
 * Created by ZhangShuzheng on 2017/01/12.
 */
public class DefaultMessageQueueListener implements MessageListener {

	private static final Logger LOGGER = LoggerFactory.getLogger(DefaultMessageQueueListener.class);

	@Autowired
	ThreadPoolTaskExecutor threadPoolTaskExecutor;

	@Override
    public void onMessage(final Message message) {
		// 使用线程池多线程处理
		threadPoolTaskExecutor.execute(new Runnable() {
			@Override
            public void run() {
				if (message instanceof TextMessage) {
					TextMessage textMessage = (TextMessage) message;
					try {
						LOGGER.info("消费消息：{}", textMessage.getText());
					} catch (Exception e){
						e.printStackTrace();
					}
				}
			}
		});
	}

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="87" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.293</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> zheng</a><br />
                                    <b> <a> File: </a> </b>  <a> DefaultMessageQueueListener.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>zheng-cms\zheng-cms-job\src\main\java\com\zheng\cms\job\jms\DefaultMessageQueueListener.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zheng.cms.job.jms;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

/**
 * MQ消费者
 * Created by ZhangShuzheng on 2016/11/24.
 */
public class DefaultMessageQueueListener implements MessageListener {

    private static final Logger LOGGER = LoggerFactory.getLogger(DefaultMessageQueueListener.class);

    @Autowired
    ThreadPoolTaskExecutor threadPoolTaskExecutor;

    @Override
    public void onMessage(final Message message) {
        // 使用线程池多线程处理
        threadPoolTaskExecutor.execute(new Runnable() {
            @Override
            public void run() {
                TextMessage textMessage = (TextMessage) message;
                try {
                    String text = textMessage.getText();
                    LOGGER.info("消费：{}", text);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-card" id="88" style="display:block">
                            <div class="layui-card-header ">
                                <h3><b><a> No.294</a></b></h3>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-word-aux">
                                    <b> <a> Project: </a> </b> <a> zheng</a><br />
                                    <b> <a> File: </a> </b>  <a> DefaultMessageQueueListener.java</a><br />
                                    <b> <a> Category: </a> </b>  <a>  DIFile &rarr; Communication Support File</a>
                                </div><hr />
                                <div class="layui-collapse" >
                                    <div class="layui-colla-item" >
                                        <h2 class="layui-colla-title">File Content</h2>
                                        <div class="layui-colla-content ">
                                            <b> <a> File Location: </a> </b>zheng-cms\zheng-cms-web\src\main\java\com\zheng\cms\web\jms\DefaultMessageQueueListener.java</a>
                                            <br />
                                            <pre class="layui-code" lay-skin="notepad" lay-height="300px">
package com.zheng.cms.web.jms;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

/**
 * MQ消费者
 * Created by ZhangShuzheng on 2016/11/24.
 */
public class DefaultMessageQueueListener implements MessageListener {

    private static final Logger LOGGER = LoggerFactory.getLogger(DefaultMessageQueueListener.class);

    @Autowired
    ThreadPoolTaskExecutor threadPoolTaskExecutor;

    @Override
    public void onMessage(final Message message) {
        // 使用线程池多线程处理
        threadPoolTaskExecutor.execute(new Runnable() {
            @Override
            public void run() {
                TextMessage textMessage = (TextMessage) message;
                try {
                    String text = textMessage.getText();
                    LOGGER.info("消费：{}", text);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

}
</pre>
                                            <br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div>
                            <div id="divpager-4"></div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>

<script>
    $(function () {
        layui.use(['laypage', 'layer'], function () {
            var laypage = layui.laypage
                , layer = layui.layer;

            laypage.render({
                elem: 'divpager-1'
                , count: 43
                , curr: 1
                , limit: __PageSize
                , jump: function (obj, first) {
                    page = obj.curr;
                    size = obj.limit;
                    for(i = 1;i <= obj.count;i++){
                        document.getElementById(i).style.display="none";
                    }
                    for (i = size * (page - 1) + 1;i <= size* page;i++){
                        if(i <= obj.count){
                            document.getElementById(i).style.display = "block";
                        }
                    }


                    if (!first) {

                    }
                }
            });
            laypage.render({
                elem: 'divpager-2'
                , count: 11
                , curr: 1
                , limit: __PageSize
                , jump: function (obj, first) {
                    page = obj.curr;
                    size = obj.limit;
                    for(i = 44;i <= obj.count + 43;i++){
                        document.getElementById(i).style.display="none";
                    }
                    for (i = size * (page - 1) + 44;i <= size* page + 43;i++){
                        if(i <= obj.count + 43){
                            document.getElementById(i).style.display = "block";
                        }
                    }
                    if (!first) {

                    }
                }
            });
            laypage.render({
                elem: 'divpager-3'
                , count: 10
                , curr: 1
                , limit: __PageSize
                , jump: function (obj, first) {
                    page = obj.curr;
                    size = obj.limit;
                    for(i = 55;i <= obj.count + 54;i++){
                        document.getElementById(i).style.display="none";
                    }
                    for (i = size * (page - 1) + 55;i <= size* page + 54;i++){
                        if(i <= obj.count + 54){
                            document.getElementById(i).style.display = "block";
                        }
                    }
                    if (!first) {

                    }
                }
            });
            laypage.render({
                elem: 'divpager-4'
                , count: 24
                , curr: 1
                , limit: __PageSize
                , jump: function (obj, first) {
                    page = obj.curr;
                    size = obj.limit;
                    for(i = 65;i <= obj.count + 64;i++){
                        document.getElementById(i).style.display="none";
                    }
                    for (i = size * (page - 1) + 65;i <= size* page + 64;i++){
                        if(i <= obj.count + 64){
                            document.getElementById(i).style.display = "block";
                        }
                    }
                    if (!first) {

                    }
                }
            });
        });
    })
</script>


    <script>
        //注意：导航 依赖 element 模块，否则无法进行功能性操作
        layui.use('element', function () {
            var element = layui.element;

        });

        document.onkeydown = function (e) { // 回车提交表单
            // 兼容FF和IE和Opera
            var theEvent = window.event || e;
            var code = theEvent.keyCode || theEvent.which || theEvent.charCode;
            if (code == 13) {
                likesearch();
            }
        }

        function likesearch() {
            var liketxt = $("#LikeKey").val();
            var url = 'http://g4.net.cn/Home/Search' + "?likekey=" + liketxt;
            document.location.href = url;
        }
    </script>

</body>
</html>
